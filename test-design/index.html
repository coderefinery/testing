

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Test design &mdash; Automated testing  documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=9edc463e" />
      <link rel="stylesheet" type="text/css" href="../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
      <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=949a1ff5" />
      <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=9c3e77be" />
      <link rel="stylesheet" type="text/css" href="../_static/sphinx_lesson.css?v=e9df6548" />
      <link rel="stylesheet" type="text/css" href="../_static/term_role_formatting.css?v=4194e21c" />
      <link rel="stylesheet" type="text/css" href="../_static/sphinx_rtd_theme_ext_color_contrast.css?v=8e8ea19f" />
      <link rel="stylesheet" type="text/css" href="../_static/tabs.css?v=a5c4661c" />

  
    <link rel="shortcut icon" href="../_static/coderefinery.ico"/>
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=187304be"></script>
      <script src="../_static/doctools.js?v=9a2dae69"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
      <script src="../_static/copybutton.js?v=582ca9e2"></script>
      <script src="../_static/minipres.js?v=a0d29692"></script>
      <script>let toggleHintShow = 'Click to show';</script>
      <script>let toggleHintHide = 'Click to hide';</script>
      <script>let toggleOpenOnPrint = 'true';</script>
      <script src="../_static/togglebutton.js?v=1ae7504c"></script>
      <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
      <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
      <script src="../_static/tabs.js?v=3030b3cb"></script>
      <script data-domain="coderefinery.github.io" defer="defer" src="https://plausible.cs.aalto.fi/js/script.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex/" />
    <link rel="search" title="Search" href="../search/" />
    <link rel="next" title="Conclusions and recommendations" href="../conclusions/" />
    <link rel="prev" title="Automated testing" href="../continuous-integration/" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../" class="icon icon-home">
            Automated testing
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search/" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">The lesson</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../motivation/">Motivation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../locally/">Testing locally</a></li>
<li class="toctree-l1"><a class="reference internal" href="../continuous-integration/">Automated testing</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Test design</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#pure-and-impure-functions">Pure and impure functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="#test-driven-development">Test-driven development</a></li>
<li class="toctree-l2"><a class="reference internal" href="#testing-randomness">Testing randomness</a></li>
<li class="toctree-l2"><a class="reference internal" href="#designing-an-end-to-end-test">Designing an end-to-end test</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../conclusions/">Conclusions and recommendations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../full-cycle-ci/">(Optional) Full-cycle collaborative workflow</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://youtu.be/xbTTDLA3txI">Shell crash course</a></li>
<li class="toctree-l1"><a class="reference internal" href="../exercises/">List of exercises</a></li>
<li class="toctree-l1"><a class="reference internal" href="../quick-reference/">Quick Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../guide/">Instructor guide</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">About</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://coderefinery.org/lessons/core/">All lessons</a></li>
<li class="toctree-l1"><a class="reference external" href="https://coderefinery.org/">CodeRefinery</a></li>
<li class="toctree-l1"><a class="reference external" href="https://coderefinery.org/lessons/reusing/">Reusing</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../">Automated testing</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Test design</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/coderefinery/testing/blob/main/content/test-design.md" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="test-design">
<h1>Test design<a class="headerlink" href="#test-design" title="Link to this heading"></a></h1>
<div class="admonition-questions questions admonition" id="questions-0">
<p class="admonition-title">Questions</p>
<ul class="simple">
<li><p>How can different types of functions and classes be tested?</p></li>
<li><p>How can the integrity of a complete program be monitored over time?</p></li>
<li><p>How can functions that involve random numbers be tested?</p></li>
</ul>
</div>
<p>In this episode we will consider how functions and programs can be tested in programs developed in different programming languages.</p>
<div class="admonition-exercise-instructions discussion important admonition" id="discussion-0">
<p class="admonition-title">Exercise instructions</p>
<p><strong>For the instructor</strong></p>
<ul class="simple">
<li><p>First motivate and give a quick tour of all exercises below (10 minutes).</p></li>
<li><p>Emphasize that the focus of this episode is <em>design</em>. It is OK to only discuss in groups and not write code.</p></li>
</ul>
<p><strong>During exercise session</strong></p>
<ul class="simple">
<li><p>Choose the exercise which interests you most. There are many more exercises than we would have time for.</p></li>
<li><p>Discuss what testing framework can be used to implement the test.</p></li>
<li><p>Keep notes, questions, and answers in the collaborative document.</p></li>
</ul>
<p><strong>Once we return to stream</strong></p>
<ul class="simple">
<li><p>Discussion about experiences learned.</p></li>
</ul>
</div>
<div class="admonition-language-specific-instructions callout admonition" id="callout-0">
<p class="admonition-title">Language-specific instructions</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-0-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab group-tab" id="tab-0-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-0-Qysr" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-0-Qysr" name="Qysr" role="tab" tabindex="-1">C++</button><button aria-controls="panel-0-Ug==" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-0-Ug==" name="Ug==" role="tab" tabindex="-1">R</button><button aria-controls="panel-0-SnVsaWE=" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-0-SnVsaWE=" name="SnVsaWE=" role="tab" tabindex="-1">Julia</button><button aria-controls="panel-0-Rm9ydHJhbg==" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-0-Rm9ydHJhbg==" name="Rm9ydHJhbg==" role="tab" tabindex="-1">Fortran</button></div><div aria-labelledby="tab-0-UHl0aG9u" class="sphinx-tabs-panel group-tab" id="panel-0-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><p>The suggested solutions below use pytest. Further information can
be found in the <a class="reference internal" href="../quick-reference/#pytest-ref"><span class="std std-ref">Quick Reference</span></a>.</p>
</div><div aria-labelledby="tab-0-Qysr" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-0-Qysr" name="Qysr" role="tabpanel" tabindex="0"><p>The suggested solutions below use Catch2. Further information can
be found in the <a class="reference internal" href="../quick-reference/#catch2"><span class="std std-ref">Quick Reference</span></a>.</p>
</div><div aria-labelledby="tab-0-Ug==" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-0-Ug==" name="Ug==" role="tabpanel" tabindex="0"><p>The suggested solutions below use testthat. Further information can
be found in the <a class="reference internal" href="../quick-reference/#testthat"><span class="std std-ref">Quick Reference</span></a>.</p>
</div><div aria-labelledby="tab-0-SnVsaWE=" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-0-SnVsaWE=" name="SnVsaWE=" role="tabpanel" tabindex="0"><p>The suggested solutions below use Test. Further information can
be found in the <a class="reference internal" href="../quick-reference/#test"><span class="std std-ref">Quick Reference</span></a>.</p>
</div><div aria-labelledby="tab-0-Rm9ydHJhbg==" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-0-Rm9ydHJhbg==" name="Rm9ydHJhbg==" role="tabpanel" tabindex="0"><p>The suggested solutions below use pFUnit. Further information on how to install
pFUnit and set up tests can
be found in the <a class="reference internal" href="../quick-reference/#pfunit"><span class="std std-ref">Quick Reference</span></a>.</p>
</div></div>
</div>
<section id="pure-and-impure-functions">
<h2>Pure and impure functions<a class="headerlink" href="#pure-and-impure-functions" title="Link to this heading"></a></h2>
<p>Start by discussing how you would design tests for the
following five functions, and then try to write the tests.
Also discuss why some are easier to test than others.</p>
<div class="admonition-design-1-design-a-test-for-a-function-that-receives-a-number-and-returns-a-number exercise important admonition" id="exercise-0">
<p class="admonition-title">Design-1: Design a test for a function that receives a number and returns a number</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-1-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab group-tab" id="tab-1-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-1-Qysr" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-1-Qysr" name="Qysr" role="tab" tabindex="-1">C++</button><button aria-controls="panel-1-Ug==" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-1-Ug==" name="Ug==" role="tab" tabindex="-1">R</button><button aria-controls="panel-1-SnVsaWE=" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-1-SnVsaWE=" name="SnVsaWE=" role="tab" tabindex="-1">Julia</button><button aria-controls="panel-1-Rm9ydHJhbg==" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-1-Rm9ydHJhbg==" name="Rm9ydHJhbg==" role="tab" tabindex="-1">Fortran</button></div><div aria-labelledby="tab-1-UHl0aG9u" class="sphinx-tabs-panel group-tab" id="panel-1-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">factorial</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Computes the factorial of n.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">n</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;received negative input&#39;</span><span class="p">)</span>
    <span class="n">result</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
        <span class="n">result</span> <span class="o">*=</span> <span class="n">i</span>
    <span class="k">return</span> <span class="n">result</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-1-Qysr" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-1-Qysr" name="Qysr" role="tabpanel" tabindex="0"><div class="highlight-C++ notranslate"><div class="highlight"><pre><span></span><span class="cm">/* Computes the factorial of n recursively. */</span>
<span class="k">constexpr</span><span class="w"> </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="nf">factorial</span><span class="p">(</span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">   </span><span class="k">return</span><span class="w"> </span><span class="p">(</span><span class="n">n</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="p">(</span><span class="n">n</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">factorial</span><span class="p">(</span><span class="n">n</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">));</span>
<span class="p">}</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-1-Ug==" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-1-Ug==" name="Ug==" role="tabpanel" tabindex="0"><div class="highlight-R notranslate"><div class="highlight"><pre><span></span><span class="c1">#&#39; Computes the factorial of n</span>
<span class="c1">#&#39;</span>
<span class="c1">#&#39; @param n The number to compute the factorial of.</span>
<span class="c1">#&#39; @return The factorial of n</span>
<span class="n">factorial</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="kr">function</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kr">if</span><span class="w"> </span><span class="p">(</span><span class="n">n</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="m">0</span><span class="p">)</span>
<span class="w">    </span><span class="nf">stop</span><span class="p">(</span><span class="s">&#39;received negative input&#39;</span><span class="p">)</span>
<span class="w">  </span><span class="kr">if</span><span class="w"> </span><span class="p">(</span><span class="n">n</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">0</span><span class="p">)</span>
<span class="w">    </span><span class="kr">return</span><span class="p">(</span><span class="m">1</span><span class="p">)</span>

<span class="w">  </span><span class="n">result</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">1</span>
<span class="w">  </span><span class="kr">for</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="kr">in</span><span class="w"> </span><span class="m">1</span><span class="o">:</span><span class="n">n</span><span class="p">)</span>
<span class="w">    </span><span class="n">result</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">i</span>
<span class="w">  </span><span class="n">result</span>
<span class="p">}</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-1-SnVsaWE=" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-1-SnVsaWE=" name="SnVsaWE=" role="tabpanel" tabindex="0"><div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="s">&quot;&quot;&quot;</span>
<span class="s">    factorial(n::Int)</span>

<span class="s">Compute the factorial of n.</span>
<span class="s">&quot;&quot;&quot;</span>
<span class="k">function</span><span class="w"> </span><span class="n">factorial</span><span class="p">(</span><span class="n">n</span><span class="o">::</span><span class="kt">Int</span><span class="p">)</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span>
<span class="w">        </span><span class="n">throw</span><span class="p">(</span><span class="kt">DomainError</span><span class="p">(</span><span class="s">&quot;n must be non-negative&quot;</span><span class="p">))</span>
<span class="w">    </span><span class="k">end</span>
<span class="w">    </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="n">n</span>
<span class="w">        </span><span class="n">result</span><span class="w"> </span><span class="o">*=</span><span class="w"> </span><span class="n">i</span>
<span class="w">    </span><span class="k">end</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">result</span>
<span class="k">end</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-1-Rm9ydHJhbg==" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-1-Rm9ydHJhbg==" name="Rm9ydHJhbg==" role="tabpanel" tabindex="0"><div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="k">module </span><span class="n">factorial_mod</span>
<span class="k">contains</span>
<span class="w">   </span><span class="c">! computes the factorial of n</span>
<span class="w">   </span><span class="kt">integer </span><span class="k">function </span><span class="n">factorial</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="w">      </span><span class="k">implicit none</span>
<span class="k">      </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">n</span>
<span class="w">      </span><span class="kt">integer </span><span class="n">r</span>
<span class="w">      </span><span class="kt">integer </span><span class="n">i</span>
<span class="w">      </span><span class="k">if</span><span class="p">(</span><span class="n">n</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">         write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;Received negative input&#39;</span>
<span class="w">         </span><span class="k">stop</span>
<span class="k">      end if</span>
<span class="k">      </span><span class="n">r</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span>
<span class="w">      </span><span class="k">do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="n">n</span>
<span class="w">         </span><span class="n">r</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r</span><span class="o">*</span><span class="n">i</span>
<span class="w">      </span><span class="k">end do</span>
<span class="k">      </span><span class="n">factorial</span><span class="o">=</span><span class="n">r</span>
<span class="w">   </span><span class="k">end function </span><span class="n">factorial</span>
<span class="k">end module </span><span class="n">factorial_mod</span>
</pre></div>
</div>
</div><p>Discussion point: The factorial grows very rapidly. What happens if you
pass a large number as argument to the function?</p>
</div>
<div class="admonition-solution solution important dropdown admonition" id="solution-0">
<p class="admonition-title">Solution</p>
<p>This is a <strong>pure function</strong> so is easy to test: inputs go to
outputs.  For example, start with the below, then think of some
what extreme cases/boundary cases there might be.  This example shows
all of the tests as one function, but you might want to make each test
function more fine-grained and test only one concept.</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-2-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab group-tab" id="tab-2-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-2-Qysr" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-2-Qysr" name="Qysr" role="tab" tabindex="-1">C++</button><button aria-controls="panel-2-Ug==" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-2-Ug==" name="Ug==" role="tab" tabindex="-1">R</button><button aria-controls="panel-2-SnVsaWE=" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-2-SnVsaWE=" name="SnVsaWE=" role="tab" tabindex="-1">Julia</button><button aria-controls="panel-2-Rm9ydHJhbg==" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-2-Rm9ydHJhbg==" name="Rm9ydHJhbg==" role="tab" tabindex="-1">Fortran</button></div><div aria-labelledby="tab-2-UHl0aG9u" class="sphinx-tabs-panel group-tab" id="panel-2-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pytest</span>

<span class="k">def</span><span class="w"> </span><span class="nf">test_factorial</span><span class="p">():</span>
    <span class="k">assert</span> <span class="n">factorial</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span>
    <span class="k">assert</span> <span class="n">factorial</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span>
    <span class="k">assert</span> <span class="n">factorial</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span>
       
</pre></div>
</div>
</div><div aria-labelledby="tab-2-Qysr" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-2-Qysr" name="Qysr" role="tabpanel" tabindex="0"><div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;catch2/catch.hpp&gt;</span>

<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;factorial.hpp&quot;</span>

<span class="n">TEST_CASE</span><span class="p">(</span><span class="s">&quot;Compute the factorial&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;[factorial]&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">REQUIRE</span><span class="p">(</span><span class="n">factorial</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
<span class="w">  </span><span class="n">REQUIRE</span><span class="p">(</span><span class="n">factorial</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
<span class="w">  </span><span class="n">REQUIRE</span><span class="p">(</span><span class="n">factorial</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">2</span><span class="p">);</span>
<span class="w">  </span><span class="n">REQUIRE</span><span class="p">(</span><span class="n">factorial</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">6</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-2-Ug==" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-2-Ug==" name="Ug==" role="tabpanel" tabindex="0"><div class="highlight-R notranslate"><div class="highlight"><pre><span></span><span class="nf">test_that</span><span class="p">(</span><span class="s">&quot;Test factorial&quot;</span><span class="p">,</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nf">expect_equal</span><span class="p">(</span><span class="nf">factorial</span><span class="p">(</span><span class="m">0</span><span class="p">),</span><span class="w"> </span><span class="m">1</span><span class="p">)</span>
<span class="w">  </span><span class="nf">expect_equal</span><span class="p">(</span><span class="nf">factorial</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="m">1</span><span class="p">)</span>
<span class="w">  </span><span class="nf">expect_equal</span><span class="p">(</span><span class="nf">factorial</span><span class="p">(</span><span class="m">2</span><span class="p">),</span><span class="w"> </span><span class="m">2</span><span class="p">)</span>
<span class="w">  </span><span class="nf">expect_equal</span><span class="p">(</span><span class="nf">factorial</span><span class="p">(</span><span class="m">3</span><span class="p">),</span><span class="w"> </span><span class="m">6</span><span class="p">)</span>
<span class="w">  </span><span class="c1"># also try negatives (check that it raises an error), non-integers, etc.</span>

<span class="w">  </span><span class="c1"># Raise an error if factorial does *not* raise an error:</span>
<span class="w">  </span><span class="nf">expect_error</span><span class="p">(</span><span class="nf">factorial</span><span class="p">(</span><span class="m">-1</span><span class="p">))</span>
<span class="p">})</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-2-SnVsaWE=" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-2-SnVsaWE=" name="SnVsaWE=" role="tabpanel" tabindex="0"><div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="nd">@testset</span><span class="w"> </span><span class="s">&quot;Test factorial function&quot;</span><span class="w"> </span><span class="k">begin</span>
<span class="w">    </span><span class="nd">@test_throws</span><span class="w"> </span><span class="kt">DomainError</span><span class="w"> </span><span class="n">factorial</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="w">    </span><span class="nd">@test</span><span class="w"> </span><span class="n">factorial</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">6</span>
<span class="k">end</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-2-Rm9ydHJhbg==" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-2-Rm9ydHJhbg==" name="Rm9ydHJhbg==" role="tabpanel" tabindex="0"><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@test</span>
<span class="n">subroutine</span> <span class="n">test_factorial</span><span class="p">()</span>
   <span class="n">use</span> <span class="n">factorial_mod</span>
   <span class="n">use</span> <span class="n">funit</span>
   <span class="nd">@assertEqual</span><span class="p">(</span><span class="mi">120</span><span class="p">,</span> <span class="n">factorial</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span> <span class="s1">&#39;factorial(5)&#39;</span><span class="p">)</span>
<span class="n">end</span> <span class="n">subroutine</span> <span class="n">test_factorial</span>
</pre></div>
</div>
</div></div>
<p>Notes on the discussion point: Programming languages differ in the way they deal with integer
overflow. Python automatically converts to the necessary <code class="docutils literal notranslate"><span class="pre">long</span></code> type, in Julia you would
observe a “wrap-around”, in C/C++ you get undefined behaviour for signed integers.
Testing for overflow likewise depends on the language.</p>
</div>
</div>
<div class="admonition-design-2-design-a-test-for-a-function-that-receives-two-strings-and-returns-a-number exercise important admonition" id="exercise-1">
<p class="admonition-title">Design-2: Design a test for a function that receives two strings and returns a number</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-3-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab group-tab" id="tab-3-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-3-Qysr" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-3-Qysr" name="Qysr" role="tab" tabindex="-1">C++</button><button aria-controls="panel-3-Ug==" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-3-Ug==" name="Ug==" role="tab" tabindex="-1">R</button><button aria-controls="panel-3-SnVsaWE=" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-3-SnVsaWE=" name="SnVsaWE=" role="tab" tabindex="-1">Julia</button><button aria-controls="panel-3-Rm9ydHJhbg==" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-3-Rm9ydHJhbg==" name="Rm9ydHJhbg==" role="tab" tabindex="-1">Fortran</button></div><div aria-labelledby="tab-3-UHl0aG9u" class="sphinx-tabs-panel group-tab" id="panel-3-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">count_word_occurrence_in_string</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">word</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Counts how often word appears in text.</span>
<span class="sd">    Example: if text is &quot;one two one two three four&quot;</span>
<span class="sd">             and word is &quot;one&quot;, then this function returns 2</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">words</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">words</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">word</span><span class="p">)</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-3-Qysr" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-3-Qysr" name="Qysr" role="tabpanel" tabindex="0"><div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;string&gt;</span>

<span class="cm">/* Counts how often word appears in text.</span>
<span class="cm"> * Example: if text is &quot;one two one two three four&quot;</span>
<span class="cm"> *          and word is &quot;one&quot;, then this function returns 2</span>
<span class="cm"> */</span>
<span class="kt">int</span><span class="w"> </span><span class="nf">count_word_occurrence_in_string</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">text</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">word</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">auto</span><span class="w"> </span><span class="n">word_count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">  </span><span class="k">auto</span><span class="w"> </span><span class="n">count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>

<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="k">auto</span><span class="w"> </span><span class="n">ch</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">text</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ch</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">word</span><span class="p">[</span><span class="n">word_count</span><span class="p">])</span><span class="w"> </span><span class="o">++</span><span class="n">word_count</span><span class="p">;</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">word</span><span class="p">[</span><span class="n">word_count</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="sc">&#39;\0&#39;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="n">word_count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">      </span><span class="o">++</span><span class="n">count</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">count</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-3-Ug==" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-3-Ug==" name="Ug==" role="tabpanel" tabindex="0"><div class="highlight-R notranslate"><div class="highlight"><pre><span></span><span class="c1">#&#39; Counts how often a given word appears in text</span>
<span class="c1">#&#39;</span>
<span class="c1">#&#39; @param text The text to search in.</span>
<span class="c1">#&#39; @param word The word to search for.</span>
<span class="c1">#&#39; @return The number of times the word occurs in the text.</span>
<span class="n">count_word_occurrence_in_string</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="kr">function</span><span class="p">(</span><span class="n">text</span><span class="p">,</span><span class="w"> </span><span class="n">word</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">words</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">strsplit</span><span class="p">(</span><span class="n">text</span><span class="p">,</span><span class="w"> </span><span class="s">&#39; &#39;</span><span class="p">)[[</span><span class="m">1</span><span class="p">]]</span>
<span class="w">  </span><span class="nf">sum</span><span class="p">(</span><span class="n">words</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">word</span><span class="p">)</span>
<span class="p">}</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-3-SnVsaWE=" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-3-SnVsaWE=" name="SnVsaWE=" role="tabpanel" tabindex="0"><div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="s">&quot;&quot;&quot;</span>
<span class="s">    count_word_occurrence_in_string(text::String, word::String)</span>

<span class="s">Count how often word appears in text.</span>
<span class="s">Example: if `text` is &quot;one two one two three four&quot;</span>
<span class="s">and `word` is &quot;one&quot;, then this function returns 2</span>
<span class="s">&quot;&quot;&quot;</span>
<span class="k">function</span><span class="w"> </span><span class="n">count_word_occurrence_in_string</span><span class="p">(</span><span class="n">text</span><span class="o">::</span><span class="kt">String</span><span class="p">,</span><span class="w"> </span><span class="n">word</span><span class="o">::</span><span class="kt">String</span><span class="p">)</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">count</span><span class="p">(</span><span class="n">word</span><span class="p">,</span><span class="w"> </span><span class="n">text</span><span class="p">)</span>

<span class="k">end</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-3-Rm9ydHJhbg==" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-3-Rm9ydHJhbg==" name="Rm9ydHJhbg==" role="tabpanel" tabindex="0"><div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="c">! missing - please submit an example</span>
</pre></div>
</div>
</div></div>
<div class="admonition-solution solution important dropdown admonition" id="solution-1">
<p class="admonition-title">Solution</p>
<p>This is again a <strong>pure function</strong> but uses strings.  Use a similar strategy
to the above.</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-4-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab group-tab" id="tab-4-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-4-Qysr" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-4-Qysr" name="Qysr" role="tab" tabindex="-1">C++</button><button aria-controls="panel-4-Ug==" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-4-Ug==" name="Ug==" role="tab" tabindex="-1">R</button><button aria-controls="panel-4-SnVsaWE=" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-4-SnVsaWE=" name="SnVsaWE=" role="tab" tabindex="-1">Julia</button><button aria-controls="panel-4-Rm9ydHJhbg==" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-4-Rm9ydHJhbg==" name="Rm9ydHJhbg==" role="tab" tabindex="-1">Fortran</button></div><div aria-labelledby="tab-4-UHl0aG9u" class="sphinx-tabs-panel group-tab" id="panel-4-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">test_count_word_occurrence_in_string</span><span class="p">():</span>
    <span class="k">assert</span> <span class="n">count_word_occurrence_in_string</span><span class="p">(</span><span class="s1">&#39;AAA BBB&#39;</span><span class="p">,</span> <span class="s1">&#39;AAA&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span>
    <span class="k">assert</span> <span class="n">count_word_occurrence_in_string</span><span class="p">(</span><span class="s1">&#39;AAA AAA&#39;</span><span class="p">,</span> <span class="s1">&#39;AAA&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span>
    <span class="c1"># What does this last test tell us?</span>
    <span class="k">assert</span> <span class="n">count_word_occurrence_in_string</span><span class="p">(</span><span class="s1">&#39;AAAAA&#39;</span><span class="p">,</span> <span class="s1">&#39;AAA&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-4-Qysr" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-4-Qysr" name="Qysr" role="tabpanel" tabindex="0"><div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;catch2/catch.hpp&gt;</span>

<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;word_count.hpp&quot;</span>

<span class="n">TEST_CASE</span><span class="p">(</span><span class="s">&quot;Count occurrences of substring in string&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;[count_word_occurrence_in_string]&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">REQUIRE</span><span class="p">(</span><span class="n">count_word_occurrence_in_string</span><span class="p">(</span><span class="s">&quot;AAA BBB&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;AAA&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
<span class="w">  </span><span class="n">REQUIRE</span><span class="p">(</span><span class="n">count_word_occurrence_in_string</span><span class="p">(</span><span class="s">&quot;AAA AAA&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;AAA&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">2</span><span class="p">);</span>
<span class="w">  </span><span class="n">REQUIRE</span><span class="p">(</span><span class="n">count_word_occurrence_in_string</span><span class="p">(</span><span class="s">&quot;AAAA&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;AAA&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-4-Ug==" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-4-Ug==" name="Ug==" role="tabpanel" tabindex="0"><div class="highlight-R notranslate"><div class="highlight"><pre><span></span><span class="nf">test_that</span><span class="p">(</span><span class="s">&quot;Test count word occurrence in string&quot;</span><span class="p">,</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nf">expect_equal</span><span class="p">(</span><span class="nf">count_word_occurrence_in_string</span><span class="p">(</span><span class="s">&quot;AAA BBB&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;AAA&quot;</span><span class="p">),</span><span class="w"> </span><span class="m">1</span><span class="p">)</span>
<span class="w">  </span><span class="nf">expect_equal</span><span class="p">(</span><span class="nf">count_word_occurrence_in_string</span><span class="p">(</span><span class="s">&quot;AAA AAA&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;AAA&quot;</span><span class="p">),</span><span class="w"> </span><span class="m">2</span><span class="p">)</span>
<span class="w">  </span><span class="nf">expect_equal</span><span class="p">(</span><span class="nf">count_word_occurrence_in_string</span><span class="p">(</span><span class="s">&quot;AAAAA&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;AAA&quot;</span><span class="p">),</span><span class="w"> </span><span class="m">0</span><span class="p">)</span>
<span class="p">})</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-4-SnVsaWE=" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-4-SnVsaWE=" name="SnVsaWE=" role="tabpanel" tabindex="0"><div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="nd">@testset</span><span class="w"> </span><span class="s">&quot;Test count word occurrence in string&quot;</span><span class="w"> </span><span class="k">begin</span>
<span class="w">    </span><span class="nd">@test</span><span class="w"> </span><span class="n">count_word_occurrence_in_string</span><span class="p">(</span><span class="s">&quot;AAA BBB&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;AAA&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span>
<span class="w">    </span><span class="nd">@test</span><span class="w"> </span><span class="n">count_word_occurrence_in_string</span><span class="p">(</span><span class="s">&quot;AAA AAA&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;AAA&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">2</span>
<span class="w">    </span><span class="nd">@test</span><span class="w"> </span><span class="n">count_word_occurrence_in_string</span><span class="p">(</span><span class="s">&quot;AAAAA&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;AAA&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span>
<span class="k">end</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-4-Rm9ydHJhbg==" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-4-Rm9ydHJhbg==" name="Rm9ydHJhbg==" role="tabpanel" tabindex="0"><div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="c">! missing - please submit an example</span>
</pre></div>
</div>
</div></div>
</div>
</div>
<div class="admonition-design-3-design-a-test-for-a-function-which-reads-a-file-and-returns-a-number exercise important admonition" id="exercise-2">
<p class="admonition-title">Design-3: Design a test for a function which reads a file and returns a number</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-5-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab group-tab" id="tab-5-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-5-Qysr" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-5-Qysr" name="Qysr" role="tab" tabindex="-1">C++</button><button aria-controls="panel-5-Ug==" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-5-Ug==" name="Ug==" role="tab" tabindex="-1">R</button><button aria-controls="panel-5-SnVsaWE=" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-5-SnVsaWE=" name="SnVsaWE=" role="tab" tabindex="-1">Julia</button><button aria-controls="panel-5-Rm9ydHJhbg==" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-5-Rm9ydHJhbg==" name="Rm9ydHJhbg==" role="tab" tabindex="-1">Fortran</button></div><div aria-labelledby="tab-5-UHl0aG9u" class="sphinx-tabs-panel group-tab" id="panel-5-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">count_word_occurrence_in_file</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span> <span class="n">word</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Counts how often word appears in file file_name.</span>
<span class="sd">    Example: if file contains &quot;one two one two three four&quot;</span>
<span class="sd">             and word is &quot;one&quot;, then this function returns 2</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">words</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
            <span class="n">count</span> <span class="o">+=</span> <span class="n">words</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">word</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">count</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-5-Qysr" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-5-Qysr" name="Qysr" role="tabpanel" tabindex="0"><div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;fstream&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;streambuf&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;string&gt;</span>

<span class="cm">/* Counts how often word appears in file fname.</span>
<span class="cm"> * Example: if file contains &quot;one two one two three four&quot;</span>
<span class="cm"> *          and word is &quot;one&quot;, then this function returns 2</span>
<span class="cm"> */</span>
<span class="kt">int</span><span class="w"> </span><span class="nf">count_word_occurrence_in_file</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">fname</span><span class="p">,</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">word</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">std</span><span class="o">::</span><span class="n">ifstream</span><span class="w"> </span><span class="n">fh</span><span class="p">(</span><span class="n">fname</span><span class="p">);</span>
<span class="w">  </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">text</span><span class="p">((</span><span class="n">std</span><span class="o">::</span><span class="n">istreambuf_iterator</span><span class="o">&lt;</span><span class="kt">char</span><span class="o">&gt;</span><span class="p">(</span><span class="n">fh</span><span class="p">)),</span>
<span class="w">		   </span><span class="n">std</span><span class="o">::</span><span class="n">istreambuf_iterator</span><span class="o">&lt;</span><span class="kt">char</span><span class="o">&gt;</span><span class="p">());</span>

<span class="w">  </span><span class="k">auto</span><span class="w"> </span><span class="n">word_count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0l</span><span class="n">u</span><span class="p">;</span><span class="w"> </span><span class="c1">// will be used for indexing and therefore it has to be *long unsigned* int for the safe conversion to &#39;std::__cxx11::basic_string&lt;char&gt;::size_type&#39;.</span>
<span class="w">  </span><span class="k">auto</span><span class="w"> </span><span class="n">count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>

<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="k">auto</span><span class="w"> </span><span class="n">ch</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">text</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ch</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">word</span><span class="p">[</span><span class="n">word_count</span><span class="p">])</span><span class="w"> </span><span class="o">++</span><span class="n">word_count</span><span class="p">;</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">word</span><span class="p">[</span><span class="n">word_count</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="sc">&#39;\0&#39;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="n">word_count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">      </span><span class="o">++</span><span class="n">count</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">count</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-5-Ug==" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-5-Ug==" name="Ug==" role="tabpanel" tabindex="0"><div class="highlight-R notranslate"><div class="highlight"><pre><span></span><span class="c1">#&#39; Counts how often a given word appears in a file.</span>
<span class="c1">#&#39;</span>
<span class="c1">#&#39; @param file_name The name of the file to search in.</span>
<span class="c1">#&#39; @param word The word to search for in the file.</span>
<span class="c1">#&#39; @return The number of times the word appeared in the file.</span>
<span class="n">count_word_occurrence_in_file</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="kr">function</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span><span class="w"> </span><span class="n">word</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">count</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">0</span>
<span class="w">  </span><span class="kr">for</span><span class="w"> </span><span class="p">(</span><span class="n">line</span><span class="w"> </span><span class="kr">in</span><span class="w"> </span><span class="nf">readLines</span><span class="p">(</span><span class="n">file_name</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">words</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">strsplit</span><span class="p">(</span><span class="n">line</span><span class="p">,</span><span class="w"> </span><span class="s">&#39; &#39;</span><span class="p">)[[</span><span class="m">1</span><span class="p">]]</span>
<span class="w">    </span><span class="n">count</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">count</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">sum</span><span class="p">(</span><span class="n">words</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">word</span><span class="p">)</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="n">count</span>
<span class="p">}</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-5-SnVsaWE=" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-5-SnVsaWE=" name="SnVsaWE=" role="tabpanel" tabindex="0"><div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="s">&quot;&quot;&quot;</span>
<span class="s">    count_word_occurrence_in_file(file_name::String, word::String)</span>

<span class="s">Counts how often word appears in file file_name.</span>
<span class="s">Example: if file contains &quot;one two one two three four&quot;</span>
<span class="s">         And word is &quot;one&quot;, then this function returns 2</span>
<span class="s">&quot;&quot;&quot;</span>
<span class="k">function</span><span class="w"> </span><span class="n">count_word_occurrence_in_file</span><span class="p">(</span><span class="n">file_name</span><span class="o">::</span><span class="kt">String</span><span class="p">,</span><span class="w"> </span><span class="n">word</span><span class="o">::</span><span class="kt">String</span><span class="p">)</span>
<span class="w">    </span><span class="n">open</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;r&quot;</span><span class="p">)</span><span class="w"> </span><span class="k">do</span><span class="w"> </span><span class="n">file</span>
<span class="w">        </span><span class="n">lines</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">readlines</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">count</span><span class="p">(</span><span class="n">word</span><span class="p">,</span><span class="w"> </span><span class="n">join</span><span class="p">(</span><span class="n">lines</span><span class="p">))</span>
<span class="w">    </span><span class="k">end</span>
<span class="k">end</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-5-Rm9ydHJhbg==" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-5-Rm9ydHJhbg==" name="Rm9ydHJhbg==" role="tabpanel" tabindex="0"><div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="c">! missing - please submit an example</span>
</pre></div>
</div>
</div></div>
<div class="admonition-solution solution important dropdown admonition" id="solution-2">
<p class="admonition-title">Solution</p>
<p>In this example we test a function which is not pure, because the output
depends on the value of a file. We can generate a temporary file for testing
and remove it afterwards.  Even better could be to split file reading from the
calculation, so that testing the calculation part becomes easy (see above).</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-6-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab group-tab" id="tab-6-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-6-Qysr" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-6-Qysr" name="Qysr" role="tab" tabindex="-1">C++</button><button aria-controls="panel-6-Ug==" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-6-Ug==" name="Ug==" role="tab" tabindex="-1">R</button><button aria-controls="panel-6-SnVsaWE=" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-6-SnVsaWE=" name="SnVsaWE=" role="tab" tabindex="-1">Julia</button><button aria-controls="panel-6-Rm9ydHJhbg==" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-6-Rm9ydHJhbg==" name="Rm9ydHJhbg==" role="tab" tabindex="-1">Fortran</button></div><div aria-labelledby="tab-6-UHl0aG9u" class="sphinx-tabs-panel group-tab" id="panel-6-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">tempfile</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">os</span>

<span class="k">def</span><span class="w"> </span><span class="nf">test_count_word_occurrence_in_file</span><span class="p">():</span>
    <span class="n">_</span><span class="p">,</span> <span class="n">temporary_file_name</span> <span class="o">=</span> <span class="n">tempfile</span><span class="o">.</span><span class="n">mkstemp</span><span class="p">()</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">temporary_file_name</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;one two one two three four&quot;</span><span class="p">)</span>
    <span class="n">count</span> <span class="o">=</span> <span class="n">count_word_occurrence_in_file</span><span class="p">(</span><span class="n">temporary_file_name</span><span class="p">,</span> <span class="s2">&quot;one&quot;</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">count</span> <span class="o">==</span> <span class="mi">2</span>
    <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">temporary_file_name</span><span class="p">)</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-6-Qysr" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-6-Qysr" name="Qysr" role="tabpanel" tabindex="0"><div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;filesystem&gt;</span><span class="c1"> // for temp_directory_path(), requires C++17.</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;fstream&gt;</span>

<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;catch2/catch.hpp&gt;</span>

<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;word_count.hpp&quot;</span>

<span class="n">TEST_CASE</span><span class="p">(</span><span class="s">&quot;Count occurrences of substring in file&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;[count_word_occurrence_in_file]&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">namespace</span><span class="w"> </span><span class="nn">fs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nn">std</span><span class="o">::</span><span class="nn">filesystem</span><span class="p">;</span>
<span class="w">  </span><span class="k">auto</span><span class="w"> </span><span class="n">tmp_dir</span><span class="p">{</span><span class="w"> </span><span class="n">fs</span><span class="o">::</span><span class="n">temp_directory_path</span><span class="p">()</span><span class="w"> </span><span class="p">};</span>
<span class="w">  </span><span class="k">auto</span><span class="w"> </span><span class="n">fpath</span><span class="p">{</span><span class="w"> </span><span class="n">fs</span><span class="o">::</span><span class="n">temp_directory_path</span><span class="p">()</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="s">&quot;temp_file&quot;</span><span class="w"> </span><span class="p">};</span>

<span class="w">  </span><span class="n">std</span><span class="o">::</span><span class="n">ofstream</span><span class="w"> </span><span class="nf">s</span><span class="p">(</span><span class="n">fpath</span><span class="p">,</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">ios</span><span class="o">::</span><span class="n">out</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">ios</span><span class="o">::</span><span class="n">trunc</span><span class="p">);</span>
<span class="w">  </span><span class="n">s</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;one two one two three four&quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
<span class="w">  </span><span class="n">s</span><span class="p">.</span><span class="n">close</span><span class="p">();</span>

<span class="w">  </span><span class="n">REQUIRE</span><span class="p">(</span><span class="n">count_word_occurrence_in_file</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;one&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">2</span><span class="p">);</span>
<span class="w">  </span><span class="n">REQUIRE</span><span class="p">(</span><span class="n">count_word_occurrence_in_file</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;three&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
<span class="w">  </span><span class="n">REQUIRE</span><span class="p">(</span><span class="n">count_word_occurrence_in_file</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;six&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>

<span class="w">  </span><span class="n">fs</span><span class="o">::</span><span class="n">remove</span><span class="p">(</span><span class="w"> </span><span class="n">fpath</span><span class="w"> </span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-6-Ug==" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-6-Ug==" name="Ug==" role="tabpanel" tabindex="0"><div class="highlight-R notranslate"><div class="highlight"><pre><span></span><span class="nf">test_that</span><span class="p">(</span><span class="s">&quot;Test count word occurrence in file&quot;</span><span class="p">,</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">fname</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">tempfile</span><span class="p">()</span>
<span class="w">  </span><span class="nf">write</span><span class="p">(</span><span class="s">&quot;one two one two three four&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">fname</span><span class="p">)</span>
<span class="w">  </span><span class="nf">expect_equal</span><span class="p">(</span><span class="nf">count_word_occurrence_in_file</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;one&quot;</span><span class="p">),</span><span class="w"> </span><span class="m">2</span><span class="p">)</span>
<span class="w">  </span><span class="nf">expect_equal</span><span class="p">(</span><span class="nf">count_word_occurrence_in_file</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;three&quot;</span><span class="p">),</span><span class="w"> </span><span class="m">1</span><span class="p">)</span>
<span class="w">  </span><span class="nf">expect_equal</span><span class="p">(</span><span class="nf">count_word_occurrence_in_file</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;six&quot;</span><span class="p">),</span><span class="w"> </span><span class="m">0</span><span class="p">)</span>
<span class="w">  </span><span class="nf">unlink</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span>
<span class="p">})</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-6-SnVsaWE=" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-6-SnVsaWE=" name="SnVsaWE=" role="tabpanel" tabindex="0"><div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="nd">@testset</span><span class="w"> </span><span class="s">&quot;Test count word occurrence in file&quot;</span><span class="w"> </span><span class="k">begin</span>
<span class="w">    </span><span class="n">msg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;one two one two three four&quot;</span>
<span class="w">    </span><span class="p">(</span><span class="n">fname</span><span class="p">,</span><span class="w"> </span><span class="n">testio</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mktemp</span><span class="p">()</span>
<span class="w">    </span><span class="n">println</span><span class="p">(</span><span class="n">testio</span><span class="p">,</span><span class="w"> </span><span class="n">msg</span><span class="p">)</span>
<span class="w">    </span><span class="n">close</span><span class="p">(</span><span class="n">testio</span><span class="p">)</span>
<span class="w">    </span><span class="nd">@test</span><span class="w"> </span><span class="n">count_word_occurrence_in_file</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;one&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">2</span>
<span class="w">    </span><span class="nd">@test</span><span class="w"> </span><span class="n">count_word_occurrence_in_file</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;three&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span>
<span class="w">    </span><span class="nd">@test</span><span class="w"> </span><span class="n">count_word_occurrence_in_file</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;six&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span>
<span class="k">end</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-6-Rm9ydHJhbg==" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-6-Rm9ydHJhbg==" name="Rm9ydHJhbg==" role="tabpanel" tabindex="0"><div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="c">! missing - please submit an example</span>
</pre></div>
</div>
</div></div>
</div>
</div>
<div class="admonition-design-4-design-a-test-for-a-function-with-an-external-dependency exercise important admonition" id="exercise-3">
<p class="admonition-title">Design-4: Design a test for a function with an external dependency</p>
<p>This one is not easy to test because the function has an external dependency.</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-7-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab group-tab" id="tab-7-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-7-Qysr" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-7-Qysr" name="Qysr" role="tab" tabindex="-1">C++</button><button aria-controls="panel-7-Ug==" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-7-Ug==" name="Ug==" role="tab" tabindex="-1">R</button><button aria-controls="panel-7-SnVsaWE=" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-7-SnVsaWE=" name="SnVsaWE=" role="tab" tabindex="-1">Julia</button><button aria-controls="panel-7-Rm9ydHJhbg==" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-7-Rm9ydHJhbg==" name="Rm9ydHJhbg==" role="tab" tabindex="-1">Fortran</button></div><div aria-labelledby="tab-7-UHl0aG9u" class="sphinx-tabs-panel group-tab" id="panel-7-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">check_reactor_temperature</span><span class="p">(</span><span class="n">temperature_celsius</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Checks whether temperature is above max_temperature</span>
<span class="sd">    and returns a status.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">reactor</span><span class="w"> </span><span class="kn">import</span> <span class="n">max_temperature</span>
    <span class="k">if</span> <span class="n">temperature_celsius</span> <span class="o">&gt;</span> <span class="n">max_temperature</span><span class="p">:</span>
        <span class="n">status</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">status</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">return</span> <span class="n">status</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-7-Qysr" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-7-Qysr" name="Qysr" role="tabpanel" tabindex="0"><div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;constants.hpp&quot;</span>
<span class="cm">/* ^--- Defines the max_temperature constant as:</span>
<span class="cm">* namespace constants {</span>
<span class="cm">* constexpr double max_temperature = 100.0;</span>
<span class="cm">* }</span>
<span class="cm">*/</span>

<span class="k">enum</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="nc">ReactorState</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">FINE</span><span class="p">,</span><span class="w"> </span><span class="n">CRITICAL</span><span class="w"> </span><span class="p">};</span>

<span class="cm">/* Checks whether temperature is above max_temperature and returns a status. */</span>
<span class="n">ReactorState</span><span class="w"> </span><span class="nf">check_reactor_temperature</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">temperature_celsius</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">temperature_celsius</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">constants</span><span class="o">::</span><span class="n">max_temperature</span>
<span class="w">	     </span><span class="o">?</span><span class="w"> </span><span class="n">ReactorState</span><span class="o">::</span><span class="n">CRITICAL</span>
<span class="w">	     </span><span class="o">:</span><span class="w"> </span><span class="n">ReactorState</span><span class="o">::</span><span class="n">FINE</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-7-Ug==" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-7-Ug==" name="Ug==" role="tabpanel" tabindex="0"><div class="highlight-R notranslate"><div class="highlight"><pre><span></span><span class="c1"># reactor &lt;- namespace::makeNamespace(&quot;reactor&quot;)</span>
<span class="c1"># assign(&quot;max_temperature&quot;, 100, env = reactor)</span>
<span class="c1"># namespaceExport(reactor, &quot;max_temperature&quot;)</span>

<span class="c1">#&#39; Checks whether the temperature is above max_temperature</span>
<span class="c1">#&#39; and returns the status.</span>
<span class="c1">#&#39;</span>
<span class="c1">#&#39; @param temperature_celsius The temperature of the core</span>
<span class="c1">#&#39; @return 1 if the temperature is in range, otherwise 0</span>
<span class="n">check_reactor_temperature</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="kr">function</span><span class="p">(</span><span class="n">temperature_celsius</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kr">if</span><span class="w"> </span><span class="p">(</span><span class="n">temperature_celsius</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">reactor</span><span class="o">::</span><span class="n">max_temperature</span><span class="p">)</span>
<span class="w">    </span><span class="n">status</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">1</span>
<span class="w">  </span><span class="kr">else</span>
<span class="w">    </span><span class="n">status</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">0</span>
<span class="w">  </span><span class="n">status</span>
<span class="p">}</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-7-SnVsaWE=" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-7-SnVsaWE=" name="SnVsaWE=" role="tabpanel" tabindex="0"><div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="c"># Importing modules inside functions is not allowed in Julia and must be done at top-level</span>
<span class="k">using</span><span class="w"> </span><span class="n">reactor</span><span class="o">:</span><span class="w"> </span><span class="n">max_temperature</span>

<span class="s">&quot;&quot;&quot;</span>
<span class="s">    check_reactor_temperature(temperature_celsius)</span>

<span class="s">Checks whether temperature is above max_temperature</span>
<span class="s">and returns a status.</span>
<span class="s">&quot;&quot;&quot;</span>
<span class="k">function</span><span class="w"> </span><span class="n">check_reactor_temperature</span><span class="p">(</span><span class="n">temperature_celsius</span><span class="p">)</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">temperature_celsius</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">max_temperature</span>
<span class="w">        </span><span class="n">status</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span>
<span class="w">    </span><span class="k">else</span>
<span class="w">        </span><span class="n">status</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">    </span><span class="k">end</span>
<span class="k">end</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-7-Rm9ydHJhbg==" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-7-Rm9ydHJhbg==" name="Rm9ydHJhbg==" role="tabpanel" tabindex="0"><div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="c">! missing - please submit an example</span>
</pre></div>
</div>
</div></div>
<div class="admonition-solution solution important dropdown admonition" id="solution-3">
<p class="admonition-title">Solution</p>
<p>This function depends on the value of
<code class="docutils literal notranslate"><span class="pre">reactor.max_temperature</span></code> so the function is not pure, so testing gets
harder. You could use monkey patching to override the value of
<code class="docutils literal notranslate"><span class="pre">max_temperature</span></code>, and test it with different values.  <a class="reference external" href="https://en.wikipedia.org/wiki/Monkey_patch">Monkey
patching</a> is the concept
of artificially changing some other value.</p>
<p>A better solution would probably be to rewrite the function.</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-8-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab group-tab" id="tab-8-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-8-Qysr" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-8-Qysr" name="Qysr" role="tab" tabindex="-1">C++</button><button aria-controls="panel-8-Ug==" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-8-Ug==" name="Ug==" role="tab" tabindex="-1">R</button><button aria-controls="panel-8-SnVsaWE=" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-8-SnVsaWE=" name="SnVsaWE=" role="tab" tabindex="-1">Julia</button><button aria-controls="panel-8-Rm9ydHJhbg==" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-8-Rm9ydHJhbg==" name="Rm9ydHJhbg==" role="tab" tabindex="-1">Fortran</button></div><div aria-labelledby="tab-8-UHl0aG9u" class="sphinx-tabs-panel group-tab" id="panel-8-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">test_set_temp</span><span class="p">(</span><span class="n">monkeypatch</span><span class="p">):</span>
    <span class="n">monkeypatch</span><span class="o">.</span><span class="n">setattr</span><span class="p">(</span><span class="n">reactor</span><span class="p">,</span> <span class="s2">&quot;max_temperature&quot;</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">check_reactor_temperature</span><span class="p">(</span><span class="mi">99</span><span class="p">)</span>  <span class="o">==</span> <span class="mi">0</span>
    <span class="k">assert</span> <span class="n">check_reactor_temperature</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span>   <span class="c1"># boundary cases easily go wrong</span>
    <span class="k">assert</span> <span class="n">check_reactor_temperature</span><span class="p">(</span><span class="mi">101</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-8-Qysr" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-8-Qysr" name="Qysr" role="tabpanel" tabindex="0"><div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="c1">// Changing variables included from headers (monkey patching) is not possible in C++.</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;catch2/catch.hpp&gt;</span>

<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;reactor.hpp&quot;</span>

<span class="n">TEST_CASE</span><span class="p">(</span><span class="s">&quot;Check reactor state&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;[reactor_state]&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">REQUIRE</span><span class="p">(</span><span class="n">check_reactor_temperature</span><span class="p">(</span><span class="mi">99</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">ReactorState</span><span class="o">::</span><span class="n">FINE</span><span class="p">);</span>
<span class="w">  </span><span class="n">REQUIRE</span><span class="p">(</span><span class="n">check_reactor_temperature</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">ReactorState</span><span class="o">::</span><span class="n">FINE</span><span class="p">);</span>
<span class="w">  </span><span class="n">REQUIRE</span><span class="p">(</span><span class="n">check_reactor_temperature</span><span class="p">(</span><span class="mi">101</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">ReactorState</span><span class="o">::</span><span class="n">CRITICAL</span><span class="p">);</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-8-Ug==" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-8-Ug==" name="Ug==" role="tabpanel" tabindex="0"><div class="highlight-R notranslate"><div class="highlight"><pre><span></span><span class="c1"># Changing variables imported from modules (monkey patching) is not possible in R.</span>
<span class="c1"># To be able to test this function properly it needs to be made pure:</span>
<span class="n">check_reactor_temperature</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="kr">function</span><span class="p">(</span><span class="n">max_temperature</span><span class="p">,</span><span class="w"> </span><span class="n">temperature_celsius</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kr">if</span><span class="w"> </span><span class="p">(</span><span class="n">temperature_celsius</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">max_temperature</span><span class="p">)</span>
<span class="w">    </span><span class="n">status</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">1</span>
<span class="w">  </span><span class="kr">else</span>
<span class="w">    </span><span class="n">status</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">0</span>
<span class="w">  </span><span class="n">status</span>
<span class="p">}</span>
<span class="nf">test_that</span><span class="p">(</span><span class="s">&quot;Test reactor temperature&quot;</span><span class="p">,</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nf">expect_equal</span><span class="p">(</span><span class="nf">check_reactor_temperature</span><span class="p">(</span><span class="m">100</span><span class="p">,</span><span class="w"> </span><span class="m">99</span><span class="p">),</span><span class="w"> </span><span class="m">0</span><span class="p">)</span>
<span class="w">  </span><span class="nf">expect_equal</span><span class="p">(</span><span class="nf">check_reactor_temperature</span><span class="p">(</span><span class="m">100</span><span class="p">,</span><span class="w"> </span><span class="m">100</span><span class="p">),</span><span class="w"> </span><span class="m">0</span><span class="p">)</span><span class="w">  </span><span class="c1"># boundary cases easily go wrong</span>
<span class="w">  </span><span class="nf">expect_equal</span><span class="p">(</span><span class="nf">check_reactor_temperature</span><span class="p">(</span><span class="m">100</span><span class="p">,</span><span class="w"> </span><span class="m">101</span><span class="p">),</span><span class="w"> </span><span class="m">1</span><span class="p">)</span>
<span class="p">})</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-8-SnVsaWE=" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-8-SnVsaWE=" name="SnVsaWE=" role="tabpanel" tabindex="0"><div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="c"># Changing variables imported from modules (monkey patching) is not possible in Julia.</span>
<span class="c"># To be able to test this function properly it needs to be made pure:</span>

<span class="k">function</span><span class="w"> </span><span class="n">check_reactor_temperature</span><span class="p">(</span><span class="n">temperature_celsius</span><span class="p">,</span><span class="w"> </span><span class="n">max_temperature</span><span class="p">)</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">temperature_celsius</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">max_temperature</span>
<span class="w">        </span><span class="n">status</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span>
<span class="w">    </span><span class="k">else</span>
<span class="w">        </span><span class="n">status</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">    </span><span class="k">end</span>
<span class="k">end</span>

<span class="c"># normal invocation:</span>
<span class="k">using</span><span class="w"> </span><span class="n">reactor</span><span class="o">:</span><span class="w"> </span><span class="n">max_temperature</span>
<span class="n">check_reactor_temperature</span><span class="p">(</span><span class="mi">99</span><span class="p">,</span><span class="w"> </span><span class="n">max_temperature</span><span class="p">)</span>

<span class="c"># tests</span>
<span class="nd">@testset</span><span class="w"> </span><span class="s">&quot;Test check_reactor_temperature function&quot;</span><span class="w"> </span><span class="k">begin</span>
<span class="w">    </span><span class="nd">@test</span><span class="w"> </span><span class="n">check_reactor_temperature</span><span class="p">(</span><span class="mi">99</span><span class="p">,</span><span class="w"> </span><span class="mi">100</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span>
<span class="w">    </span><span class="nd">@test</span><span class="w"> </span><span class="n">check_reactor_temperature</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span><span class="w"> </span><span class="mi">100</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="w">   </span><span class="c"># boundary cases easily go wrong</span>
<span class="w">    </span><span class="nd">@test</span><span class="w"> </span><span class="n">check_reactor_temperature</span><span class="p">(</span><span class="mi">101</span><span class="p">,</span><span class="w"> </span><span class="mi">100</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span>
<span class="k">end</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-8-Rm9ydHJhbg==" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-8-Rm9ydHJhbg==" name="Rm9ydHJhbg==" role="tabpanel" tabindex="0"><div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="c">! also here, not easy to test and better rewrite the function</span>
</pre></div>
</div>
</div></div>
</div>
</div>
<div class="admonition-design-5-design-a-test-for-a-method-of-a-mutable-class exercise important admonition" id="exercise-4">
<p class="admonition-title">Design-5: Design a test for a method of a mutable class</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-9-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab group-tab" id="tab-9-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-9-Qysr" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-9-Qysr" name="Qysr" role="tab" tabindex="-1">C++</button><button aria-controls="panel-9-Ug==" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-9-Ug==" name="Ug==" role="tab" tabindex="-1">R</button><button aria-controls="panel-9-SnVsaWE=" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-9-SnVsaWE=" name="SnVsaWE=" role="tab" tabindex="-1">Julia</button><button aria-controls="panel-9-Rm9ydHJhbg==" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-9-Rm9ydHJhbg==" name="Rm9ydHJhbg==" role="tab" tabindex="-1">Fortran</button></div><div aria-labelledby="tab-9-UHl0aG9u" class="sphinx-tabs-panel group-tab" id="panel-9-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">Pet</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hunger</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">go_for_a_walk</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># &lt;-- how would you test this function?</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hunger</span> <span class="o">+=</span> <span class="mi">1</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-9-Qysr" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-9-Qysr" name="Qysr" role="tabpanel" tabindex="0"><div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;string&gt;</span>

<span class="k">class</span><span class="w"> </span><span class="nc">Pet</span><span class="w"> </span><span class="p">{</span>
<span class="w"> </span><span class="k">private</span><span class="o">:</span>
<span class="w">  </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">hunger_</span><span class="p">{</span><span class="mi">0</span><span class="p">};</span>
<span class="w">  </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">name_</span><span class="p">{};</span>

<span class="w"> </span><span class="k">public</span><span class="o">:</span>
<span class="w">  </span><span class="k">explicit</span><span class="w"> </span><span class="n">Pet</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">name</span><span class="p">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">name_</span><span class="p">(</span><span class="n">name</span><span class="p">)</span><span class="w"> </span><span class="p">{}</span>
<span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="n">go_for_a_walk</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">hunger_</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="p">}</span>
<span class="w">  </span><span class="c1">// ^-- how would you test this function?</span>
<span class="w">  </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">hunger</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">hunger_</span><span class="p">;</span><span class="w"> </span><span class="p">}</span>
<span class="p">};</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-9-Ug==" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-9-Ug==" name="Ug==" role="tabpanel" tabindex="0"><div class="highlight-R notranslate"><div class="highlight"><pre><span></span><span class="n">Pet</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="kr">function</span><span class="p">(</span><span class="n">name</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nf">structure</span><span class="p">(</span>
<span class="w">    </span><span class="nf">list</span><span class="p">(</span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">hunger</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">),</span>
<span class="w">    </span><span class="n">class</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Pet&quot;</span>
<span class="w">  </span><span class="p">)</span>
<span class="p">}</span>

<span class="c1"># How would you test this function?</span>
<span class="n">take_for_a_walk</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="kr">function</span><span class="p">(</span><span class="n">pet</span><span class="p">)</span><span class="w"> </span><span class="nf">UseMethod</span><span class="p">(</span><span class="s">&quot;take_for_a_walk&quot;</span><span class="p">)</span>
<span class="n">take_for_a_walk.Pet</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="kr">function</span><span class="p">(</span><span class="n">pet</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">pet</span><span class="o">$</span><span class="n">hunger</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">pet</span><span class="o">$</span><span class="n">hunger</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="m">1</span>
<span class="w">  </span><span class="n">pet</span>
<span class="p">}</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-9-SnVsaWE=" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-9-SnVsaWE=" name="SnVsaWE=" role="tabpanel" tabindex="0"><div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="c"># the closest thing to a class in Julia is a `mutable struct`</span>
<span class="k">mutable</span><span class="w"> </span><span class="k">struct</span> <span class="kt">Pet</span>
<span class="w">    </span><span class="n">name</span><span class="o">::</span><span class="kt">String</span>
<span class="w">    </span><span class="n">hunger</span><span class="o">::</span><span class="kt">Int64</span>
<span class="k">end</span>

<span class="k">function</span><span class="w"> </span><span class="n">go_for_a_walk!</span><span class="p">(</span><span class="n">pet</span><span class="o">::</span><span class="kt">Pet</span><span class="p">)</span>
<span class="w">    </span><span class="n">pet</span><span class="o">.</span><span class="n">hunger</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="mi">1</span>
<span class="k">end</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-9-Rm9ydHJhbg==" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-9-Rm9ydHJhbg==" name="Rm9ydHJhbg==" role="tabpanel" tabindex="0"><div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="c">! missing - please submit an example</span>
</pre></div>
</div>
</div></div>
<div class="admonition-solution solution important dropdown admonition" id="solution-4">
<p class="admonition-title">Solution</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-10-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab group-tab" id="tab-10-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-10-Qysr" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-10-Qysr" name="Qysr" role="tab" tabindex="-1">C++</button><button aria-controls="panel-10-Ug==" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-10-Ug==" name="Ug==" role="tab" tabindex="-1">R</button><button aria-controls="panel-10-SnVsaWE=" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-10-SnVsaWE=" name="SnVsaWE=" role="tab" tabindex="-1">Julia</button><button aria-controls="panel-10-Rm9ydHJhbg==" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-10-Rm9ydHJhbg==" name="Rm9ydHJhbg==" role="tab" tabindex="-1">Fortran</button></div><div aria-labelledby="tab-10-UHl0aG9u" class="sphinx-tabs-panel group-tab" id="panel-10-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">test_pet</span><span class="p">():</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">Pet</span><span class="p">(</span><span class="s1">&#39;fido&#39;</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">p</span><span class="o">.</span><span class="n">hunger</span> <span class="o">==</span> <span class="mi">0</span>
    <span class="n">p</span><span class="o">.</span><span class="n">go_for_a_walk</span><span class="p">()</span>
    <span class="k">assert</span> <span class="n">p</span><span class="o">.</span><span class="n">hunger</span> <span class="o">==</span> <span class="mi">1</span>

    <span class="n">p</span><span class="o">.</span><span class="n">hunger</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
    <span class="n">p</span><span class="o">.</span><span class="n">go_for_a_walk</span><span class="p">()</span>
    <span class="k">assert</span> <span class="n">p</span><span class="o">.</span><span class="n">hunger</span> <span class="o">==</span> <span class="mi">0</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-10-Qysr" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-10-Qysr" name="Qysr" role="tabpanel" tabindex="0"><div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;catch2/catch.hpp&gt;</span>

<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;pet.hpp&quot;</span>

<span class="n">TEST_CASE</span><span class="p">(</span><span class="s">&quot;Check my pets&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;[pets]&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">auto</span><span class="w"> </span><span class="n">fido</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Pet</span><span class="p">(</span><span class="s">&quot;fido&quot;</span><span class="p">);</span>
<span class="w">  </span><span class="n">REQUIRE</span><span class="p">(</span><span class="n">fido</span><span class="p">.</span><span class="n">hunger</span><span class="p">()</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>

<span class="w">  </span><span class="n">fido</span><span class="p">.</span><span class="n">go_for_a_walk</span><span class="p">();</span>
<span class="w">  </span><span class="n">REQUIRE</span><span class="p">(</span><span class="n">fido</span><span class="p">.</span><span class="n">hunger</span><span class="p">()</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-10-Ug==" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-10-Ug==" name="Ug==" role="tabpanel" tabindex="0"><div class="highlight-R notranslate"><div class="highlight"><pre><span></span><span class="nf">test_that</span><span class="p">(</span><span class="s">&quot;Test Pet class&quot;</span><span class="p">,</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">p</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">Pet</span><span class="p">(</span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;fido&quot;</span><span class="p">)</span>
<span class="w">  </span><span class="nf">expect_equal</span><span class="p">(</span><span class="n">p</span><span class="o">$</span><span class="n">hunger</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">)</span>
<span class="w">  </span><span class="n">p</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">take_for_a_walk</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="w">  </span><span class="nf">expect_equal</span><span class="p">(</span><span class="n">p</span><span class="o">$</span><span class="n">hunger</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">)</span>

<span class="w">  </span><span class="n">p</span><span class="o">$</span><span class="n">hunger</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">-1</span>
<span class="w">  </span><span class="n">p</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">take_for_a_walk</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="w">  </span><span class="nf">expect_equal</span><span class="p">(</span><span class="n">p</span><span class="o">$</span><span class="n">hunger</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">)</span>
<span class="p">})</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-10-SnVsaWE=" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-10-SnVsaWE=" name="SnVsaWE=" role="tabpanel" tabindex="0"><div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="c"># create the mutable struct and test it</span>
<span class="nd">@testset</span><span class="w"> </span><span class="s">&quot;Test mutable struct&quot;</span><span class="w"> </span><span class="k">begin</span>
<span class="w">    </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Pet</span><span class="p">(</span><span class="s">&quot;fido&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
<span class="w">    </span><span class="nd">@test</span><span class="w"> </span><span class="n">p</span><span class="o">.</span><span class="n">hunger</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span>
<span class="w">    </span><span class="n">go_for_a_walk!</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="w">    </span><span class="nd">@test</span><span class="w"> </span><span class="n">p</span><span class="o">.</span><span class="n">hunger</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span>
<span class="w">    </span><span class="n">p</span><span class="o">.</span><span class="n">hunger</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span>
<span class="w">    </span><span class="n">go_for_a_walk!</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="w">    </span><span class="nd">@test</span><span class="w"> </span><span class="n">p</span><span class="o">.</span><span class="n">hunger</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span>
<span class="k">end</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-10-Rm9ydHJhbg==" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-10-Rm9ydHJhbg==" name="Rm9ydHJhbg==" role="tabpanel" tabindex="0"><div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="c">! missing - please submit an example</span>
</pre></div>
</div>
</div></div>
</div>
</div>
</section>
<section id="test-driven-development">
<h2>Test-driven development<a class="headerlink" href="#test-driven-development" title="Link to this heading"></a></h2>
<div class="admonition-design-6-experience-test-driven-development exercise important admonition" id="exercise-5">
<p class="admonition-title">Design-6: Experience test-driven development</p>
<p>Write a test before writing the function! You can decide yourself
what your unwritten function should do, but as a suggestion it can
be based on <a class="reference external" href="https://en.wikipedia.org/wiki/Fizz_buzz">FizzBuzz</a> - i.e.
a function that:</p>
<ul class="simple">
<li><p>takes an integer argument</p></li>
<li><p>for arguments that are multiples of three, returns “Fizz”</p></li>
<li><p>for arguments that are multiples of five, returns “Buzz”</p></li>
<li><p>for arguments that are multiples of both three and five, returns “FizzBuzz”</p></li>
<li><p>fails in case of non-integer arguments or integer arguments 0 or negative</p></li>
<li><p>otherwise returns the integer itself</p></li>
</ul>
<p>When writing the tests, consider the different ways that the function could
and should fail.</p>
<p>After you have written the tests, implement the function and run the tests
until they pass.</p>
<div class="admonition-solution solution important dropdown admonition" id="solution-5">
<p class="admonition-title">Solution</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-11-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab group-tab" id="tab-11-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-11-Qysr" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-11-Qysr" name="Qysr" role="tab" tabindex="-1">C++</button><button aria-controls="panel-11-Ug==" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-11-Ug==" name="Ug==" role="tab" tabindex="-1">R</button><button aria-controls="panel-11-SnVsaWE=" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-11-SnVsaWE=" name="SnVsaWE=" role="tab" tabindex="-1">Julia</button><button aria-controls="panel-11-Rm9ydHJhbg==" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-11-Rm9ydHJhbg==" name="Rm9ydHJhbg==" role="tab" tabindex="-1">Fortran</button></div><div aria-labelledby="tab-11-UHl0aG9u" class="sphinx-tabs-panel group-tab" id="panel-11-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pytest</span>

<span class="k">def</span><span class="w"> </span><span class="nf">fizzbuzz</span><span class="p">(</span><span class="n">number</span><span class="p">):</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">number</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span>
    <span class="k">if</span> <span class="n">number</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span>
    <span class="k">elif</span> <span class="n">number</span> <span class="o">%</span> <span class="mi">15</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;FizzBuzz&quot;</span>
    <span class="k">elif</span> <span class="n">number</span> <span class="o">%</span> <span class="mi">3</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;Fizz&quot;</span>
    <span class="k">elif</span> <span class="n">number</span> <span class="o">%</span> <span class="mi">5</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;Buzz&quot;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">number</span>

<span class="k">def</span><span class="w"> </span><span class="nf">test_fizzbuzz</span><span class="p">():</span>
    <span class="n">expected_result</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;Fizz&quot;</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="s2">&quot;Buzz&quot;</span><span class="p">,</span> <span class="s2">&quot;Fizz&quot;</span><span class="p">,</span>
                       <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="s2">&quot;Fizz&quot;</span><span class="p">,</span> <span class="s2">&quot;Buzz&quot;</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="s2">&quot;Fizz&quot;</span><span class="p">,</span>
                       <span class="mi">13</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="s2">&quot;FizzBuzz&quot;</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="s2">&quot;Fizz&quot;</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span> <span class="s2">&quot;Buzz&quot;</span><span class="p">]</span>
    <span class="n">obtained_result</span> <span class="o">=</span> <span class="p">[</span><span class="n">fizzbuzz</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">21</span><span class="p">)]</span>

    <span class="k">assert</span> <span class="n">obtained_result</span> <span class="o">==</span> <span class="n">expected_result</span>

    <span class="k">with</span> <span class="n">pytest</span><span class="o">.</span><span class="n">raises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">):</span>
        <span class="n">fizzbuzz</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">)</span>
    <span class="k">with</span> <span class="n">pytest</span><span class="o">.</span><span class="n">raises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">):</span>
        <span class="n">fizzbuzz</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

    <span class="k">with</span> <span class="n">pytest</span><span class="o">.</span><span class="n">raises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">):</span>
        <span class="n">fizzbuzz</span><span class="p">(</span><span class="mf">1.5</span><span class="p">)</span>
    <span class="k">with</span> <span class="n">pytest</span><span class="o">.</span><span class="n">raises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">):</span>
        <span class="n">fizzbuzz</span><span class="p">(</span><span class="s2">&quot;rabbit&quot;</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">main</span><span class="p">():</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">fizzbuzz</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-11-Qysr" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-11-Qysr" name="Qysr" role="tabpanel" tabindex="0"><div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="c1">// in the fizzbuzz.hpp header file</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;string&gt;</span>

<span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="nf">fizzbuzz</span><span class="p">(</span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">n</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="mi">15</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="s">&quot;FizzBuzz&quot;</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">n</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="s">&quot;Fizz&quot;</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">n</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="s">&quot;Buzz&quot;</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">to_string</span><span class="p">(</span><span class="n">n</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="c1">// in the source file for the main executable</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;cstdlib&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;iostream&gt;</span>

<span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="k">auto</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">100</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">fizzbuzz</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="c1">// in the source file for the test</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;string&gt;</span>

<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;catch2/catch.hpp&gt;</span>

<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;fizzbuzz.hpp&quot;</span>

<span class="n">TEST_CASE</span><span class="p">(</span><span class="s">&quot;FizzBuzz&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;[fizzbuzz]&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">auto</span><span class="w"> </span><span class="n">expected</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&gt;</span><span class="p">{</span>
<span class="w">	</span><span class="s">&quot;1&quot;</span><span class="p">,</span><span class="w">        </span><span class="s">&quot;2&quot;</span><span class="p">,</span><span class="w">    </span><span class="s">&quot;Fizz&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;4&quot;</span><span class="p">,</span><span class="w">    </span><span class="s">&quot;Buzz&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Fizz&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;7&quot;</span><span class="p">,</span>
<span class="w">	</span><span class="s">&quot;8&quot;</span><span class="p">,</span><span class="w">        </span><span class="s">&quot;Fizz&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Buzz&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;11&quot;</span><span class="p">,</span><span class="w">   </span><span class="s">&quot;Fizz&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;13&quot;</span><span class="p">,</span><span class="w">   </span><span class="s">&quot;14&quot;</span><span class="p">,</span>
<span class="w">	</span><span class="s">&quot;FizzBuzz&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;16&quot;</span><span class="p">,</span><span class="w">   </span><span class="s">&quot;17&quot;</span><span class="p">,</span><span class="w">   </span><span class="s">&quot;Fizz&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;19&quot;</span><span class="p">,</span><span class="w">   </span><span class="s">&quot;Buzz&quot;</span><span class="p">};</span>

<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="k">auto</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">21</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">REQUIRE</span><span class="p">(</span><span class="n">fizzbuzz</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">expected</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-11-Ug==" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-11-Ug==" name="Ug==" role="tabpanel" tabindex="0"><div class="highlight-R notranslate"><div class="highlight"><pre><span></span><span class="c1"># define the function</span>
<span class="n">fizz_buzz</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="kr">function</span><span class="p">(</span><span class="n">number</span><span class="p">){</span>
<span class="w">  </span><span class="kr">if</span><span class="p">(</span><span class="o">!</span><span class="n">number</span><span class="o">%%</span><span class="m">1</span><span class="o">==</span><span class="m">0</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="m">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">     </span><span class="nf">stop</span><span class="p">(</span><span class="s">&quot;non-integer or negative input not allowed!&quot;</span><span class="p">)</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="kr">if</span><span class="p">(</span><span class="n">number</span><span class="o">%%</span><span class="m">3</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">number</span><span class="o">%%</span><span class="m">5</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kr">return</span><span class="p">(</span><span class="s">&#39;FizzBuzz&#39;</span><span class="p">)</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="kr">else</span><span class="w"> </span><span class="kr">if</span><span class="p">(</span><span class="n">number</span><span class="o">%%</span><span class="m">3</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kr">return</span><span class="p">(</span><span class="s">&#39;Fizz&#39;</span><span class="p">)</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="kr">else</span><span class="w"> </span><span class="kr">if</span><span class="w"> </span><span class="p">(</span><span class="n">number</span><span class="o">%%</span><span class="m">5</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">0</span><span class="p">){</span>
<span class="w">    </span><span class="kr">return</span><span class="p">(</span><span class="s">&#39;Buzz&#39;</span><span class="p">)</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="kr">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kr">return</span><span class="p">(</span><span class="n">number</span><span class="p">)</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span>
<span class="p">}</span>

<span class="c1"># apply it to the numbers 1 to 50</span>
<span class="kr">for</span><span class="w"> </span><span class="p">(</span><span class="n">number</span><span class="w"> </span><span class="kr">in</span><span class="w"> </span><span class="m">1</span><span class="o">:</span><span class="m">50</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nf">print</span><span class="p">(</span><span class="nf">fizz_buzz</span><span class="p">(</span><span class="n">number</span><span class="p">))</span>
<span class="p">}</span>


<span class="nf">library</span><span class="p">(</span><span class="n">testthat</span><span class="p">)</span>

<span class="nf">test_that</span><span class="p">(</span><span class="s">&quot;Test FizzBuzz&quot;</span><span class="p">,</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nf">expect_equal</span><span class="p">(</span><span class="nf">fizz_buzz</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="m">1</span><span class="p">)</span>
<span class="w">  </span><span class="nf">expect_equal</span><span class="p">(</span><span class="nf">fizz_buzz</span><span class="p">(</span><span class="m">2</span><span class="p">),</span><span class="w"> </span><span class="m">2</span><span class="p">)</span>
<span class="w">  </span><span class="nf">expect_equal</span><span class="p">(</span><span class="nf">fizz_buzz</span><span class="p">(</span><span class="m">3</span><span class="p">),</span><span class="w"> </span><span class="s">&#39;Fizz&#39;</span><span class="p">)</span>
<span class="w">  </span><span class="nf">expect_equal</span><span class="p">(</span><span class="nf">fizz_buzz</span><span class="p">(</span><span class="m">4</span><span class="p">),</span><span class="w"> </span><span class="m">4</span><span class="p">)</span>
<span class="w">  </span><span class="nf">expect_equal</span><span class="p">(</span><span class="nf">fizz_buzz</span><span class="p">(</span><span class="m">5</span><span class="p">),</span><span class="w"> </span><span class="s">&#39;Buzz&#39;</span><span class="p">)</span>
<span class="w">  </span><span class="nf">expect_equal</span><span class="p">(</span><span class="nf">fizz_buzz</span><span class="p">(</span><span class="m">15</span><span class="p">),</span><span class="w"> </span><span class="s">&#39;FizzBuzz&#39;</span><span class="p">)</span><span class="w">  </span>

<span class="w">  </span><span class="nf">expect_error</span><span class="p">(</span><span class="nf">fizz_buzz</span><span class="p">(</span><span class="m">-1</span><span class="p">))</span>
<span class="w">  </span><span class="nf">expect_error</span><span class="p">(</span><span class="nf">fizz_buzz</span><span class="p">(</span><span class="m">1.5</span><span class="p">))</span>
<span class="w">  </span><span class="nf">expect_error</span><span class="p">(</span><span class="nf">fizz_buzz</span><span class="p">(</span><span class="s">&#39;rabbit&#39;</span><span class="p">))</span><span class="w">    </span>
<span class="p">})</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-11-SnVsaWE=" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-11-SnVsaWE=" name="SnVsaWE=" role="tabpanel" tabindex="0"><div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="k">using</span><span class="w"> </span><span class="n">Test</span>

<span class="k">function</span><span class="w"> </span><span class="n">fizzbuzz</span><span class="p">(</span><span class="n">number</span><span class="o">::</span><span class="kt">Int</span><span class="p">)</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">1</span>
<span class="w">        </span><span class="n">throw</span><span class="p">(</span><span class="kt">DomainError</span><span class="p">(</span><span class="n">number</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;number needs to be 1 or higher&quot;</span><span class="p">))</span>
<span class="w">    </span><span class="k">elseif</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="mi">15</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="s">&quot;FizzBuzz&quot;</span>
<span class="w">    </span><span class="k">elseif</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="s">&quot;Fizz&quot;</span>
<span class="w">    </span><span class="k">elseif</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="s">&quot;Buzz&quot;</span>
<span class="w">    </span><span class="k">else</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">number</span>
<span class="w">    </span><span class="k">end</span>
<span class="k">end</span>

<span class="nd">@testset</span><span class="w"> </span><span class="k">begin</span>
<span class="w">    </span><span class="n">expected_result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Fizz&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Buzz&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Fizz&quot;</span><span class="p">,</span>
<span class="w">                       </span><span class="mi">7</span><span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Fizz&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Buzz&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">11</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Fizz&quot;</span><span class="p">,</span>
<span class="w">                       </span><span class="mi">13</span><span class="p">,</span><span class="w"> </span><span class="mi">14</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;FizzBuzz&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">16</span><span class="p">,</span><span class="w"> </span><span class="mi">17</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Fizz&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">19</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Buzz&quot;</span><span class="p">]</span>
<span class="w">    </span><span class="n">obtained_result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">fizzbuzz</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="mi">20</span><span class="p">]</span>

<span class="w">    </span><span class="nd">@test</span><span class="w"> </span><span class="n">obtained_result</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">expected_result</span>

<span class="w">    </span><span class="nd">@test_throws</span><span class="w"> </span><span class="kt">MethodError</span><span class="w"> </span><span class="n">fizzbuzz</span><span class="p">(</span><span class="mf">1.5</span><span class="p">)</span>
<span class="w">    </span><span class="nd">@test_throws</span><span class="w"> </span><span class="kt">DomainError</span><span class="w"> </span><span class="n">fizzbuzz</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="w">    </span><span class="nd">@test_throws</span><span class="w"> </span><span class="kt">DomainError</span><span class="w"> </span><span class="n">fizzbuzz</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">)</span>

<span class="k">end</span>

<span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="mi">20</span>
<span class="w">    </span><span class="n">println</span><span class="p">(</span><span class="n">fizzbuzz</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
<span class="k">end</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-11-Rm9ydHJhbg==" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-11-Rm9ydHJhbg==" name="Rm9ydHJhbg==" role="tabpanel" tabindex="0"><div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="k">module </span><span class="n">fizzbuzz_mod</span>
<span class="k">contains</span>
<span class="w">   </span><span class="c">! Evaluates the fizzbuzz of n</span>
<span class="w">   </span><span class="kt">character</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span><span class="w"> </span><span class="k">function </span><span class="n">fizzbuzz</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="w">      </span><span class="k">implicit none</span>
<span class="k">      </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">n</span>
<span class="w">      </span><span class="kt">character</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span><span class="w"> </span><span class="n">str1</span>
<span class="w">      </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="nb">mod</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="mi">15</span><span class="p">)</span><span class="o">==</span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">         </span><span class="n">str1</span><span class="o">=</span><span class="s1">&#39;FizzBuzz&#39;</span>
<span class="w">      </span><span class="k">else if</span><span class="p">(</span><span class="w"> </span><span class="nb">mod</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="o">==</span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">         </span><span class="n">str1</span><span class="o">=</span><span class="s1">&#39;Fizz&#39;</span>
<span class="w">         </span><span class="n">str1</span><span class="o">=</span><span class="n">str1</span>
<span class="w">      </span><span class="k">else if</span><span class="p">(</span><span class="w"> </span><span class="nb">mod</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span><span class="o">==</span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">         </span><span class="n">str1</span><span class="o">=</span><span class="s1">&#39;Buzz&#39;</span>
<span class="w">      </span><span class="k">else if</span><span class="p">(</span><span class="w"> </span><span class="n">n</span><span class="o">&lt;</span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">         </span><span class="n">str1</span><span class="o">=</span><span class="s1">&#39;Err n&lt;0&#39;</span>
<span class="w">      </span><span class="k">else</span>
<span class="k">         </span><span class="n">str1</span><span class="o">=</span><span class="nb">char</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="w">      </span><span class="k">end if</span>
<span class="k">      </span><span class="n">fizzbuzz</span><span class="o">=</span><span class="n">str1</span>
<span class="w">   </span><span class="k">end function </span><span class="n">fizzbuzz</span>
<span class="k">end module </span><span class="n">fizzbuzz_mod</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@test</span>
<span class="n">subroutine</span> <span class="n">test_fizzbuzz</span><span class="p">()</span>
   <span class="n">use</span> <span class="n">fizzbuzz_mod</span>
   <span class="n">use</span> <span class="n">funit</span>
   <span class="nd">@assertEqual</span><span class="p">(</span><span class="s1">&#39;Fizz&#39;</span><span class="p">,</span> <span class="n">fizzbuzz</span><span class="p">(</span><span class="mi">12</span><span class="p">),</span> <span class="s1">&#39;fizzbuzz(12)&#39;</span><span class="p">)</span>
   <span class="nd">@assertEqual</span><span class="p">(</span><span class="s1">&#39;Buzz&#39;</span><span class="p">,</span> <span class="n">fizzbuzz</span><span class="p">(</span><span class="mi">25</span><span class="p">),</span> <span class="s1">&#39;fizzbuzz(25)&#39;</span><span class="p">)</span>
   <span class="nd">@assertEqual</span><span class="p">(</span><span class="s1">&#39;FizzBuzz&#39;</span><span class="p">,</span> <span class="n">fizzbuzz</span><span class="p">(</span><span class="mi">60</span><span class="p">),</span> <span class="s1">&#39;fizzbuzz(60)&#39;</span><span class="p">)</span>
<span class="n">end</span> <span class="n">subroutine</span> <span class="n">test_fizzbuzz</span>
</pre></div>
</div>
</div></div>
</div>
</div>
</section>
<section id="testing-randomness">
<h2>Testing randomness<a class="headerlink" href="#testing-randomness" title="Link to this heading"></a></h2>
<p>How would you test functions which generate random numbers
according to some distribution/statistics?</p>
<p>Functions and modules which contain randomness are
more difficult to test than pure deterministic functions, but
many strategies exist:</p>
<ul class="simple">
<li><p>For unit tests we can use fixed random seeds.</p></li>
<li><p>Try to test whether your results follow the expected
distribution/statistics.</p></li>
<li><p>When you verify your code “by eye”, what are you looking at? Now try
to express that in a script.</p></li>
</ul>
<div class="admonition-design-7-write-two-different-types-of-tests-for-randomness exercise important admonition" id="exercise-6">
<p class="admonition-title">Design-7: Write two different types of tests for randomness</p>
<p>Consider the code below which simulates playing
<a class="reference external" href="https://en.wikipedia.org/wiki/Yahtzee">Yahtzee</a> by using
random numbers. How would you go about testing it?</p>
<p>Try to write two types of tests:</p>
<ul class="simple">
<li><p>a <em>unit test</em> for the <code class="docutils literal notranslate"><span class="pre">roll_dice</span></code> function. Since it uses
random numbers, you will need to <strong>set the random seed</strong>,
pre-calculate what sequence of dice throws you get with that seed,
and use that in your test.</p></li>
<li><p>a test of the <code class="docutils literal notranslate"><span class="pre">yahtzee</span></code> function which considers the statistical
probability of obtaining a “Yahtzee” (5 dice with the same value
after three throws), which is around 4.6%. This test will be
an <em>integration test</em> since it tests multiple functions including the
random number generator itself.</p></li>
</ul>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-12-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab group-tab" id="tab-12-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-12-Qysr" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-12-Qysr" name="Qysr" role="tab" tabindex="-1">C++</button><button aria-controls="panel-12-Ug==" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-12-Ug==" name="Ug==" role="tab" tabindex="-1">R</button><button aria-controls="panel-12-SnVsaWE=" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-12-SnVsaWE=" name="SnVsaWE=" role="tab" tabindex="-1">Julia</button></div><div aria-labelledby="tab-12-UHl0aG9u" class="sphinx-tabs-panel group-tab" id="panel-12-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">random</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">collections</span><span class="w"> </span><span class="kn">import</span> <span class="n">Counter</span>


<span class="k">def</span><span class="w"> </span><span class="nf">roll_dice</span><span class="p">(</span><span class="n">num_dice</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">])</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_dice</span><span class="p">)]</span>


<span class="k">def</span><span class="w"> </span><span class="nf">yahtzee</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Play yahtzee with 5 6-sided dice and 3 throws.</span>
<span class="sd">    Collect as many of the same dice side as possible.</span>
<span class="sd">    Returns the number of same sides.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># first throw</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">roll_dice</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
    <span class="n">most_common_side</span><span class="p">,</span> <span class="n">how_often</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">(</span><span class="n">result</span><span class="p">)</span><span class="o">.</span><span class="n">most_common</span><span class="p">(</span><span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

    <span class="c1"># we keep the most common side</span>
    <span class="n">target_side</span> <span class="o">=</span> <span class="n">most_common_side</span>
    <span class="n">num_same_sides</span> <span class="o">=</span> <span class="n">how_often</span>
    <span class="k">if</span> <span class="n">num_same_sides</span> <span class="o">==</span> <span class="mi">5</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">5</span>

    <span class="c1"># second and third throw</span>
    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]:</span>
        <span class="n">throw</span> <span class="o">=</span> <span class="n">roll_dice</span><span class="p">(</span><span class="mi">5</span> <span class="o">-</span> <span class="n">num_same_sides</span><span class="p">)</span>
        <span class="n">num_same_sides</span> <span class="o">+=</span> <span class="n">Counter</span><span class="p">(</span><span class="n">throw</span><span class="p">)[</span><span class="n">target_side</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">num_same_sides</span> <span class="o">==</span> <span class="mi">5</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">5</span>

    <span class="k">return</span> <span class="n">num_same_sides</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">num_games</span> <span class="o">=</span> <span class="mi">100</span>

    <span class="n">winning_games</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span>
        <span class="nb">filter</span><span class="p">(</span>
            <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">==</span> <span class="mi">5</span><span class="p">,</span>
            <span class="p">[</span><span class="n">yahtzee</span><span class="p">()</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_games</span><span class="p">)],</span>
        <span class="p">)</span>
    <span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;out of the </span><span class="si">{</span><span class="n">num_games</span><span class="si">}</span><span class="s2"> games, </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">winning_games</span><span class="p">)</span><span class="si">}</span><span class="s2"> got a yahtzee!&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-12-Qysr" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-12-Qysr" name="Qysr" role="tabpanel" tabindex="0"><div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;cstdlib&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;iostream&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;random&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;tuple&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;vector&gt;</span>

<span class="cm">/* Roll a fair die n_dice times. The faces of the die can be set (default is 1 to 6).</span>
<span class="cm"> * The PRNG engine is moved in the function such that changes in its state are propagated back to the caller.</span>
<span class="cm"> */</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span><span class="w"> </span><span class="nc">PRNGEngine</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">decltype</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">default_random_engine</span><span class="p">())</span><span class="o">&gt;</span>
<span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="n">roll_dice</span><span class="p">(</span>
<span class="w">    </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">n_dice</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="n">faces</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="mi">6</span><span class="p">},</span>
<span class="w">    </span><span class="n">PRNGEngine</span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">gen</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">default_random_engine</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">random_device</span><span class="p">()()))</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1">// create a fair die</span>
<span class="w">  </span><span class="k">auto</span><span class="w"> </span><span class="n">weights</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="p">(</span><span class="n">faces</span><span class="p">.</span><span class="n">size</span><span class="p">(),</span><span class="w"> </span><span class="mf">1.0</span><span class="p">);</span>
<span class="w">  </span><span class="k">auto</span><span class="w"> </span><span class="n">fair_dice</span><span class="w"> </span><span class="o">=</span>
<span class="w">      </span><span class="n">std</span><span class="o">::</span><span class="n">discrete_distribution</span><span class="o">&lt;</span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="o">&gt;</span><span class="p">(</span><span class="n">weights</span><span class="p">.</span><span class="n">begin</span><span class="p">(),</span><span class="w"> </span><span class="n">weights</span><span class="p">.</span><span class="n">end</span><span class="p">());</span>

<span class="w">  </span><span class="k">auto</span><span class="w"> </span><span class="n">rolls</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="o">&gt;</span><span class="p">(</span><span class="n">n_dice</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="k">auto</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0u</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">n_dice</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">rolls</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">faces</span><span class="p">[</span><span class="n">fair_dice</span><span class="p">(</span><span class="n">gen</span><span class="p">)];</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">rolls</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/* count how many times each face comes up */</span>
<span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="n">count</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="o">&gt;&amp;</span><span class="w"> </span><span class="n">toss</span><span class="p">,</span>
<span class="w">				</span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="o">&gt;&amp;</span><span class="w"> </span><span class="n">faces</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">				    </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="mi">6</span><span class="p">})</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">auto</span><span class="w"> </span><span class="n">face_counts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="o">&gt;</span><span class="p">(</span><span class="n">faces</span><span class="p">.</span><span class="n">size</span><span class="p">(),</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="k">auto</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">faces</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="w"> </span><span class="o">++</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">face_counts</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">count</span><span class="p">(</span><span class="n">toss</span><span class="p">.</span><span class="n">cbegin</span><span class="p">(),</span><span class="w"> </span><span class="n">toss</span><span class="p">.</span><span class="n">cend</span><span class="p">(),</span><span class="w"> </span><span class="n">faces</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">face_counts</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">std</span><span class="o">::</span><span class="n">tuple</span><span class="o">&lt;</span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="p">,</span><span class="w"> </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="n">yahtzee</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">auto</span><span class="w"> </span><span class="n">n_dice</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5</span><span class="p">;</span>
<span class="w">  </span><span class="k">auto</span><span class="w"> </span><span class="n">faces</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="o">&gt;</span><span class="p">{</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="mi">6</span><span class="p">};</span>
<span class="w">  </span><span class="k">auto</span><span class="w"> </span><span class="n">toss</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">faces</span><span class="p">](</span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">n_dice</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">roll_dice</span><span class="p">(</span><span class="n">n_dice</span><span class="p">,</span><span class="w"> </span><span class="n">faces</span><span class="p">);</span><span class="w"> </span><span class="p">};</span>
<span class="w">  </span><span class="c1">// throw all dice</span>
<span class="w">  </span><span class="k">auto</span><span class="w"> </span><span class="n">first_toss</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">toss</span><span class="p">(</span><span class="n">n_dice</span><span class="p">);</span>
<span class="w">  </span><span class="k">auto</span><span class="w"> </span><span class="n">face_counts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">count</span><span class="p">(</span><span class="n">first_toss</span><span class="p">);</span>

<span class="w">  </span><span class="k">auto</span><span class="w"> </span><span class="n">it_max</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">max_element</span><span class="p">(</span><span class="n">face_counts</span><span class="p">.</span><span class="n">cbegin</span><span class="p">(),</span><span class="w"> </span><span class="n">face_counts</span><span class="p">.</span><span class="n">cend</span><span class="p">());</span>
<span class="w">  </span><span class="c1">// number of faces that showed the most</span>
<span class="w">  </span><span class="k">auto</span><span class="w"> </span><span class="n">n_collected</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">*</span><span class="n">it_max</span><span class="p">;</span>
<span class="w">  </span><span class="c1">// corresponding index in the array, will be used to get which face showed up</span>
<span class="w">  </span><span class="c1">// the most</span>
<span class="w">  </span><span class="k">auto</span><span class="w"> </span><span class="n">idx_max</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">distance</span><span class="p">(</span><span class="n">face_counts</span><span class="p">.</span><span class="n">cbegin</span><span class="p">(),</span><span class="w"> </span><span class="n">it_max</span><span class="p">);</span>

<span class="w">  </span><span class="c1">// all 5 dice showed the same face! YAHTZEE!</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">n_collected</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">5</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">make_tuple</span><span class="p">(</span><span class="n">faces</span><span class="p">[</span><span class="n">idx_max</span><span class="p">],</span><span class="w"> </span><span class="n">n_collected</span><span class="p">);</span>

<span class="w">  </span><span class="c1">// no yahtzee :(</span>
<span class="w">  </span><span class="c1">// we throw (n_dice - n_collected) dice</span>
<span class="w">  </span><span class="k">auto</span><span class="w"> </span><span class="n">second_toss</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">toss</span><span class="p">(</span><span class="n">n_dice</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">n_collected</span><span class="p">);</span>
<span class="w">  </span><span class="n">n_collected</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">count</span><span class="p">(</span><span class="n">second_toss</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="n">faces</span><span class="p">[</span><span class="n">idx_max</span><span class="p">]})[</span><span class="mi">0</span><span class="p">];</span>
<span class="w">  </span><span class="c1">// YAHTZEE!</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">n_collected</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">5</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">make_tuple</span><span class="p">(</span><span class="n">faces</span><span class="p">[</span><span class="n">idx_max</span><span class="p">],</span><span class="w"> </span><span class="n">n_collected</span><span class="p">);</span>

<span class="w">  </span><span class="c1">// final chance</span>
<span class="w">  </span><span class="k">auto</span><span class="w"> </span><span class="n">third_toss</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">toss</span><span class="p">(</span><span class="n">n_dice</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">n_collected</span><span class="p">);</span>
<span class="w">  </span><span class="n">n_collected</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">count</span><span class="p">(</span><span class="n">third_toss</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="n">faces</span><span class="p">[</span><span class="n">idx_max</span><span class="p">]})[</span><span class="mi">0</span><span class="p">];</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">make_tuple</span><span class="p">(</span><span class="n">faces</span><span class="p">[</span><span class="n">idx_max</span><span class="p">],</span><span class="w"> </span><span class="n">n_collected</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">int</span><span class="w"> </span><span class="n">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="k">auto</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">100</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">times</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">tie</span><span class="p">(</span><span class="n">value</span><span class="p">,</span><span class="w"> </span><span class="n">times</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">yahtzee</span><span class="p">();</span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;We got &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot; &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">times</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot; times in round &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">i</span>
<span class="w">	      </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">times</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">5</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;YAHTZEE in round &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">EXIT_SUCCESS</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-12-Ug==" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-12-Ug==" name="Ug==" role="tabpanel" tabindex="0"><div class="highlight-R notranslate"><div class="highlight"><pre><span></span><span class="c1">#&#39; Roll a fair die num_dice times.</span>
<span class="c1">#&#39; Collect as many of the same dice side as possible.</span>
<span class="c1">#&#39;</span>
<span class="c1">#&#39; @return A vector of die throw results</span>
<span class="n">roll_dice</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="kr">function</span><span class="p">(</span><span class="n">num_dice</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nf">ceiling</span><span class="p">(</span><span class="nf">runif</span><span class="p">(</span><span class="n">num_dice</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">6</span><span class="p">))</span>
<span class="p">}</span>

<span class="c1">#&#39; Play yahtzee with 5 6-sided dice and 3 throws.</span>
<span class="c1">#&#39; Collect as many of the same dice side as possible.</span>
<span class="c1">#&#39;</span>
<span class="c1">#&#39; @return The number of same sides</span>
<span class="n">yahtzee</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="kr">function</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">res</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">roll_dice</span><span class="p">(</span><span class="m">5</span><span class="p">)</span>
<span class="w">  </span><span class="n">most_common_side</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">as.numeric</span><span class="p">(</span><span class="nf">names</span><span class="p">(</span><span class="nf">table</span><span class="p">(</span><span class="n">res</span><span class="p">)[</span><span class="nf">which.max</span><span class="p">(</span><span class="nf">table</span><span class="p">(</span><span class="n">res</span><span class="p">))]))[</span><span class="m">1</span><span class="p">]</span>
<span class="w">  </span><span class="n">how_often</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">as.vector</span><span class="p">(</span><span class="nf">table</span><span class="p">(</span><span class="n">res</span><span class="p">)[</span><span class="nf">which.max</span><span class="p">(</span><span class="nf">table</span><span class="p">(</span><span class="n">res</span><span class="p">))])[</span><span class="m">1</span><span class="p">]</span>

<span class="w">  </span><span class="c1"># we keep the most common side</span>
<span class="w">  </span><span class="n">target_side</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">most_common_side</span>
<span class="w">  </span><span class="n">num_same_sides</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">how_often</span>
<span class="w">  </span><span class="kr">if</span><span class="w"> </span><span class="p">(</span><span class="n">num_same_sides</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">5</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kr">return</span><span class="p">(</span><span class="m">5</span><span class="p">)</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1"># second and third throw</span>
<span class="w">  </span><span class="kr">for</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="kr">in</span><span class="w"> </span><span class="m">2</span><span class="o">:</span><span class="m">3</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">throw</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">roll_dice</span><span class="p">(</span><span class="m">5</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">num_same_sides</span><span class="p">)</span>
<span class="w">    </span><span class="n">num_same_sides</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">num_same_sides</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">sum</span><span class="p">(</span><span class="n">throw</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">target_side</span><span class="p">)</span>

<span class="w">    </span><span class="kr">if</span><span class="w"> </span><span class="p">(</span><span class="n">num_same_sides</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">5</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="kr">return</span><span class="p">(</span><span class="m">5</span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="kr">return</span><span class="p">(</span><span class="n">num_same_sides</span><span class="p">)</span>
<span class="p">}</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-12-SnVsaWE=" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-12-SnVsaWE=" name="SnVsaWE=" role="tabpanel" tabindex="0"><div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="k">using</span><span class="w"> </span><span class="n">Random</span>

<span class="s">&quot;&quot;&quot;</span>
<span class="s">    roll_dice(n_dice::Int=5, sides=(1,2,3,4,5,6))</span>

<span class="s">Returns array of n_dice random integers corresponding to the sides of dice</span>
<span class="s">&quot;&quot;&quot;</span>
<span class="k">function</span><span class="w"> </span><span class="n">roll_dice</span><span class="p">(</span><span class="n">n_dice</span><span class="o">::</span><span class="kt">Int</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="n">sides</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">[</span><span class="n">rand</span><span class="p">(</span><span class="n">sides</span><span class="p">)</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="n">n_dice</span><span class="p">]</span>
<span class="k">end</span>

<span class="s">&quot;&quot;&quot;</span>
<span class="s">    yahtzee()</span>

<span class="s">Play Yahtzee with 5 6-sided dice and 3 throws.</span>
<span class="s">Collect as many of the same dice side as possible.</span>
<span class="s">Returns a tuple with the collected side (e.g. 4&#39;s) and</span>
<span class="s">how many of that side (between 1 and 5).</span>
<span class="s">&quot;&quot;&quot;</span>
<span class="k">function</span><span class="w"> </span><span class="n">yahtzee</span><span class="p">()</span>
<span class="w">    </span><span class="n">sides</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span>
<span class="w">    </span><span class="n">n_dice</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5</span>
<span class="w">    </span><span class="c"># we first throw all dice</span>
<span class="w">    </span><span class="n">first_throw</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">roll_dice</span><span class="p">(</span><span class="n">n_dice</span><span class="p">,</span><span class="w"> </span><span class="n">sides</span><span class="p">)</span>
<span class="w">    </span><span class="c"># count how many times each side comes up</span>
<span class="w">    </span><span class="n">side_counts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">count</span><span class="p">(</span><span class="n">x</span><span class="o">-&gt;</span><span class="n">x</span><span class="o">==</span><span class="n">i</span><span class="p">,</span><span class="n">first_throw</span><span class="p">)</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">sides</span><span class="p">]</span>
<span class="w">    </span><span class="c"># collected_side is the dice side we will start collecting</span>
<span class="w">    </span><span class="n">n_collected</span><span class="p">,</span><span class="w"> </span><span class="n">collected_side</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">findmax</span><span class="p">(</span><span class="n">side_counts</span><span class="p">)</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">n_collected</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">5</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">collected_side</span><span class="p">,</span><span class="w"> </span><span class="n">n_collected</span>
<span class="w">    </span><span class="k">end</span>

<span class="w">    </span><span class="c"># now we throw n_dice-n_collected dice and hope to get more collected_side</span>
<span class="w">    </span><span class="n">second_throw</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">roll_dice</span><span class="p">(</span><span class="n">n_dice</span><span class="o">-</span><span class="n">n_collected</span><span class="p">,</span><span class="w"> </span><span class="n">sides</span><span class="p">)</span>
<span class="w">    </span><span class="n">n_new_matches</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">count</span><span class="p">(</span><span class="n">x</span><span class="o">-&gt;</span><span class="n">x</span><span class="o">==</span><span class="n">collected_side</span><span class="p">,</span><span class="n">second_throw</span><span class="p">)</span>
<span class="w">    </span><span class="n">n_collected</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">n_new_matches</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">n_collected</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">5</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">collected_side</span><span class="p">,</span><span class="w"> </span><span class="n">n_collected</span>
<span class="w">    </span><span class="k">end</span>

<span class="w">    </span><span class="c"># final throw...</span>
<span class="w">    </span><span class="n">third_throw</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">roll_dice</span><span class="p">(</span><span class="n">n_dice</span><span class="o">-</span><span class="n">n_collected</span><span class="p">,</span><span class="w"> </span><span class="n">sides</span><span class="p">)</span>
<span class="w">    </span><span class="n">n_new_matches</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">count</span><span class="p">(</span><span class="n">x</span><span class="o">-&gt;</span><span class="n">x</span><span class="o">==</span><span class="n">collected_side</span><span class="p">,</span><span class="n">third_throw</span><span class="p">)</span>
<span class="w">    </span><span class="n">n_collected</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">n_new_matches</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">collected_side</span><span class="p">,</span><span class="w"> </span><span class="n">n_collected</span>
<span class="k">end</span>


<span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="mi">10</span>
<span class="w">    </span><span class="n">collected_side</span><span class="p">,</span><span class="w"> </span><span class="n">n_collected</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">yahtzee</span><span class="p">()</span>
<span class="w">    </span><span class="n">println</span><span class="p">(</span><span class="s">&quot;We got </span><span class="si">$n_collected</span><span class="s"> </span><span class="si">$collected_side</span><span class="s">&#39;s in this round&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">n_collected</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">5</span>
<span class="w">        </span><span class="n">println</span><span class="p">(</span><span class="s">&quot;Yay, it&#39;s a Yahtzee!&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="k">end</span>
<span class="k">end</span>
</pre></div>
</div>
</div></div>
<div class="admonition-solution solution important dropdown admonition" id="solution-6">
<p class="admonition-title">Solution</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-13-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab group-tab" id="tab-13-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-13-Qysr" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-13-Qysr" name="Qysr" role="tab" tabindex="-1">C++</button><button aria-controls="panel-13-Ug==" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-13-Ug==" name="Ug==" role="tab" tabindex="-1">R</button><button aria-controls="panel-13-SnVsaWE=" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-13-SnVsaWE=" name="SnVsaWE=" role="tab" tabindex="-1">Julia</button></div><div aria-labelledby="tab-13-UHl0aG9u" class="sphinx-tabs-panel group-tab" id="panel-13-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">test_roll_dice</span><span class="p">():</span>
    <span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">roll_dice</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">==</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
    <span class="k">assert</span> <span class="n">roll_dice</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">==</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
    <span class="k">assert</span> <span class="n">roll_dice</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">==</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>


<span class="kn">import</span><span class="w"> </span><span class="nn">pytest</span>
<span class="k">def</span><span class="w"> </span><span class="nf">test_yahtzee</span><span class="p">():</span>
    <span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">n_tests</span> <span class="o">=</span> <span class="mi">1_000_000</span>

    <span class="n">winning_games</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span>
        <span class="nb">filter</span><span class="p">(</span>
            <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">==</span> <span class="mi">5</span><span class="p">,</span>
            <span class="p">[</span><span class="n">yahtzee</span><span class="p">()</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_tests</span><span class="p">)],</span>
        <span class="p">)</span>
    <span class="p">)</span>

    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">winning_games</span><span class="p">)</span> <span class="o">/</span> <span class="n">n_tests</span> <span class="o">==</span> <span class="n">pytest</span><span class="o">.</span><span class="n">approx</span><span class="p">(</span><span class="mf">0.046</span><span class="p">,</span> <span class="nb">abs</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-13-Qysr" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-13-Qysr" name="Qysr" role="tabpanel" tabindex="0"><div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;random&gt;</span>

<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;catch2/catch.hpp&gt;</span>

<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;yahtzee.hpp&quot;</span>

<span class="k">using</span><span class="w"> </span><span class="k">namespace</span><span class="w"> </span><span class="nn">Catch</span><span class="o">::</span><span class="nn">literals</span><span class="p">;</span>

<span class="n">TEST_CASE</span><span class="p">(</span><span class="s">&quot;Tossing 5 dice&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;[toss]&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">auto</span><span class="w"> </span><span class="n">n_dice</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5</span><span class="p">;</span>
<span class="w">  </span><span class="k">auto</span><span class="w"> </span><span class="n">faces</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="o">&gt;</span><span class="p">{</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="mi">6</span><span class="p">};</span>

<span class="w">  </span><span class="c1">// we fix both the random device and the random engine.</span>
<span class="w">  </span><span class="c1">// the latter is necessary since the default random engine is implementation-dependent</span>
<span class="w">  </span><span class="n">std</span><span class="o">::</span><span class="n">mt19937</span><span class="w"> </span><span class="n">prng</span><span class="p">;</span>
<span class="w">  </span><span class="n">prng</span><span class="p">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">1234</span><span class="p">);</span>

<span class="w">  </span><span class="k">auto</span><span class="w"> </span><span class="n">expected_1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="o">&gt;</span><span class="p">{</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="mi">6</span><span class="p">};</span>
<span class="w">  </span><span class="k">auto</span><span class="w"> </span><span class="n">toss_1</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">roll_dice</span><span class="p">(</span><span class="n">n_dice</span><span class="p">,</span><span class="w"> </span><span class="n">faces</span><span class="p">,</span><span class="w"> </span><span class="n">prng</span><span class="p">);</span>
<span class="w">  </span><span class="n">REQUIRE</span><span class="p">(</span><span class="n">toss_1</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">expected_1</span><span class="p">);</span>

<span class="w">  </span><span class="k">auto</span><span class="w"> </span><span class="n">expected_2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="o">&gt;</span><span class="p">{</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">};</span>
<span class="w">  </span><span class="k">auto</span><span class="w"> </span><span class="n">toss_2</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">roll_dice</span><span class="p">(</span><span class="n">n_dice</span><span class="p">,</span><span class="w"> </span><span class="n">faces</span><span class="p">,</span><span class="w"> </span><span class="n">prng</span><span class="p">);</span>
<span class="w">  </span><span class="n">REQUIRE</span><span class="p">(</span><span class="n">toss_2</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">expected_2</span><span class="p">);</span>

<span class="w">  </span><span class="k">auto</span><span class="w"> </span><span class="n">expected_3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="o">&gt;</span><span class="p">{</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">};</span>
<span class="w">  </span><span class="k">auto</span><span class="w"> </span><span class="n">toss_3</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">roll_dice</span><span class="p">(</span><span class="n">n_dice</span><span class="p">,</span><span class="w"> </span><span class="n">faces</span><span class="p">,</span><span class="w"> </span><span class="n">prng</span><span class="p">);</span>
<span class="w">  </span><span class="n">REQUIRE</span><span class="p">(</span><span class="n">toss_3</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">expected_3</span><span class="p">);</span>
<span class="p">}</span>

<span class="n">TEST_CASE</span><span class="p">(</span><span class="s">&quot;Distribution of Yahtzee&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;[yahtzee]&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1">// try a million throws and see if we get close</span>
<span class="w">  </span><span class="c1">// to the statistical average of 4.6%</span>
<span class="w">  </span><span class="c1">// (https://en.wikipedia.org/wiki/Yahtzee#Probabilities)</span>
<span class="w">  </span><span class="k">auto</span><span class="w"> </span><span class="n">n_yahtzees</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">  </span><span class="k">auto</span><span class="w"> </span><span class="n">n_trials</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1e6</span><span class="p">;</span>

<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="k">auto</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">n_trials</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">times</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">tie</span><span class="p">(</span><span class="n">value</span><span class="p">,</span><span class="w"> </span><span class="n">times</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">yahtzee</span><span class="p">();</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">times</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">5</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="o">++</span><span class="n">n_yahtzees</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="n">REQUIRE</span><span class="p">(</span><span class="w"> </span><span class="n">n_yahtzees</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">n_tests</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mf">0.046</span><span class="n">_a</span><span class="p">)</span>
<span class="p">}</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-13-Ug==" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-13-Ug==" name="Ug==" role="tabpanel" tabindex="0"><div class="highlight-R notranslate"><div class="highlight"><pre><span></span><span class="kr">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nf">require</span><span class="p">(</span><span class="n">testthat</span><span class="p">))</span><span class="w"> </span><span class="nf">install.packages</span><span class="p">(</span><span class="n">testthat</span><span class="p">)</span>

<span class="nf">test_that</span><span class="p">(</span><span class="s">&quot;dice is working&quot;</span><span class="p">,</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nf">set.seed</span><span class="p">(</span><span class="m">42</span><span class="p">)</span>
<span class="w">  </span><span class="nf">expect_equal</span><span class="p">(</span><span class="nf">roll_dice</span><span class="p">(</span><span class="m">5</span><span class="p">),</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">6</span><span class="p">,</span><span class="w"> </span><span class="m">6</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="m">5</span><span class="p">,</span><span class="w"> </span><span class="m">4</span><span class="p">))</span>
<span class="w">  </span><span class="nf">expect_equal</span><span class="p">(</span><span class="nf">roll_dice</span><span class="p">(</span><span class="m">5</span><span class="p">),</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">4</span><span class="p">,</span><span class="w"> </span><span class="m">5</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">4</span><span class="p">,</span><span class="w"> </span><span class="m">5</span><span class="p">))</span>
<span class="w">  </span><span class="nf">expect_equal</span><span class="p">(</span><span class="nf">roll_dice</span><span class="p">(</span><span class="m">5</span><span class="p">),</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">3</span><span class="p">,</span><span class="w"> </span><span class="m">5</span><span class="p">,</span><span class="w"> </span><span class="m">6</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="m">3</span><span class="p">))</span>
<span class="p">})</span>


<span class="nf">test_that</span><span class="p">(</span><span class="s">&quot;yahtzee is working&quot;</span><span class="p">,</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">n_games</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">1e6</span><span class="w"> </span><span class="c1">#could be very slow, when in doubt change to 1e4</span>

<span class="w">  </span><span class="n">n_winning</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">sum</span><span class="p">(</span><span class="nf">replicate</span><span class="p">(</span><span class="n">n_games</span><span class="p">,</span><span class="w"> </span><span class="nf">yahtzee</span><span class="p">())</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">5</span><span class="p">)</span>
<span class="w">  </span><span class="n">res</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="p">(</span><span class="n">n_winning</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">n_games</span><span class="p">)</span>
<span class="w">  </span><span class="n">expected</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">0.046</span>
<span class="w">  </span><span class="nf">expect_lt</span><span class="p">(</span><span class="nf">abs</span><span class="p">(</span><span class="n">res</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">expected</span><span class="p">),</span><span class="w"> </span><span class="m">0.003</span><span class="p">)</span>
<span class="p">})</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-13-SnVsaWE=" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-13-SnVsaWE=" name="SnVsaWE=" role="tabpanel" tabindex="0"><div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="k">using</span><span class="w"> </span><span class="n">Test</span>
<span class="k">using</span><span class="w"> </span><span class="n">Random</span>

<span class="n">include</span><span class="p">(</span><span class="s">&quot;yahtzee.jl&quot;</span><span class="p">)</span>

<span class="nd">@testset</span><span class="w"> </span><span class="s">&quot;test roll_dice&quot;</span><span class="w"> </span><span class="k">begin</span>
<span class="w">    </span><span class="c"># fix random seed</span>
<span class="w">    </span><span class="n">Random</span><span class="o">.</span><span class="n">seed!</span><span class="p">(</span><span class="mi">1234</span><span class="p">);</span>
<span class="w">    </span><span class="c"># known sequence for given seed</span>
<span class="w">    </span><span class="n">exp_first_throw</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">6</span><span class="p">]</span>
<span class="w">    </span><span class="n">exp_second_throw</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">6</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">]</span>
<span class="w">    </span><span class="n">exp_third_throw</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">]</span>

<span class="w">    </span><span class="n">n_dice</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5</span>
<span class="w">    </span><span class="n">sides</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span>
<span class="w">    </span><span class="n">throw</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">roll_dice</span><span class="p">(</span><span class="n">n_dice</span><span class="p">,</span><span class="w"> </span><span class="n">sides</span><span class="p">)</span>
<span class="w">    </span><span class="nd">@test</span><span class="w"> </span><span class="n">throw</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">exp_first_throw</span>
<span class="w">    </span><span class="n">throw</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">roll_dice</span><span class="p">(</span><span class="n">n_dice</span><span class="p">,</span><span class="w"> </span><span class="n">sides</span><span class="p">)</span>
<span class="w">    </span><span class="nd">@test</span><span class="w"> </span><span class="n">throw</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">exp_second_throw</span>
<span class="w">    </span><span class="n">throw</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">roll_dice</span><span class="p">(</span><span class="n">n_dice</span><span class="p">,</span><span class="w"> </span><span class="n">sides</span><span class="p">)</span>
<span class="w">    </span><span class="nd">@test</span><span class="w"> </span><span class="n">throw</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">exp_third_throw</span>
<span class="k">end</span>

<span class="nd">@testset</span><span class="w"> </span><span class="s">&quot;testing yahtzee&quot;</span><span class="w"> </span><span class="k">begin</span>
<span class="w">    </span><span class="c"># try a million throws and see if we get close</span>
<span class="w">    </span><span class="c"># to the statistical average of 4.6%</span>
<span class="w">    </span><span class="c"># (https://en.wikipedia.org/wiki/Yahtzee#Probabilities)</span>
<span class="w">    </span><span class="n">n_yahtzees</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">    </span><span class="n">n_tests</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1_000_000</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="n">n_tests</span>
<span class="w">        </span><span class="n">collected_side</span><span class="p">,</span><span class="w"> </span><span class="n">n_collected</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">yahtzee</span><span class="p">()</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">n_collected</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">5</span>
<span class="w">            </span><span class="n">n_yahtzees</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="mi">1</span>
<span class="w">        </span><span class="k">end</span>
<span class="w">    </span><span class="k">end</span>
<span class="w">    </span><span class="nd">@test</span><span class="w"> </span><span class="n">n_yahtzees</span><span class="o">/</span><span class="n">n_tests</span><span class="w"> </span><span class="o">≈</span><span class="w"> </span><span class="mf">0.046</span><span class="w"> </span><span class="n">atol</span><span class="o">=</span><span class="mf">0.001</span>
<span class="k">end</span>
</pre></div>
</div>
</div></div>
</div>
</div>
</section>
<section id="designing-an-end-to-end-test">
<h2>Designing an end-to-end test<a class="headerlink" href="#designing-an-end-to-end-test" title="Link to this heading"></a></h2>
<p>In this exercise we will practice designing an end-to-end test.
In an end-to-end test (or integration test), the unit is the entire program.
We typically feed the program with some well defined input and verify
that it still produces the expected output by comparing it to some reference.</p>
<div class="admonition-design-8-design-but-not-write-an-end-to-end-test-for-the-uniq-program exercise important admonition" id="exercise-7">
<p class="admonition-title">Design-8: Design (but not write) an end-to-end test for the uniq program</p>
<p>To have a tangible example, let us consider the <code class="docutils literal notranslate"><span class="pre">uniq</span></code> command. This command
can read a file or an input stream and remove consecutive repetition.
The program behind <code class="docutils literal notranslate"><span class="pre">uniq</span></code> has been written by somebody else, it probably contains
some functions, but we will not look into it but regard it as “black box”.</p>
<p>If we have a file called <code class="docutils literal notranslate"><span class="pre">repetitive-text.txt</span></code> containing:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="nb">all</span> <span class="n">together</span> <span class="n">now</span><span class="p">)</span> <span class="nb">all</span> <span class="n">together</span> <span class="n">now</span>
<span class="p">(</span><span class="nb">all</span> <span class="n">together</span> <span class="n">now</span><span class="p">)</span> <span class="nb">all</span> <span class="n">together</span> <span class="n">now</span>
<span class="p">(</span><span class="nb">all</span> <span class="n">together</span> <span class="n">now</span><span class="p">)</span> <span class="nb">all</span> <span class="n">together</span> <span class="n">now</span>
<span class="p">(</span><span class="nb">all</span> <span class="n">together</span> <span class="n">now</span><span class="p">)</span> <span class="nb">all</span> <span class="n">together</span> <span class="n">now</span>
<span class="p">(</span><span class="nb">all</span> <span class="n">together</span> <span class="n">now</span><span class="p">)</span> <span class="nb">all</span> <span class="n">together</span> <span class="n">now</span>
<span class="n">another</span> <span class="n">line</span>
<span class="n">another</span> <span class="n">line</span>
<span class="n">another</span> <span class="n">line</span>
<span class="n">another</span> <span class="n">line</span>
<span class="n">intermission</span>
<span class="n">more</span> <span class="n">repetition</span>
<span class="n">more</span> <span class="n">repetition</span>
<span class="n">more</span> <span class="n">repetition</span>
<span class="n">more</span> <span class="n">repetition</span>
<span class="n">more</span> <span class="n">repetition</span>
<span class="p">(</span><span class="nb">all</span> <span class="n">together</span> <span class="n">now</span><span class="p">)</span> <span class="nb">all</span> <span class="n">together</span> <span class="n">now</span>
<span class="p">(</span><span class="nb">all</span> <span class="n">together</span> <span class="n">now</span><span class="p">)</span> <span class="nb">all</span> <span class="n">together</span> <span class="n">now</span>
</pre></div>
</div>
<p>… then feeding this input file to <code class="docutils literal notranslate"><span class="pre">uniq</span></code> like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ uniq &lt; repetitive-text.txt
</pre></div>
</div>
<p>… will produce the following output with repetitions removed:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="nb">all</span> <span class="n">together</span> <span class="n">now</span><span class="p">)</span> <span class="nb">all</span> <span class="n">together</span> <span class="n">now</span>
<span class="n">another</span> <span class="n">line</span>
<span class="n">intermission</span>
<span class="n">more</span> <span class="n">repetition</span>
<span class="p">(</span><span class="nb">all</span> <span class="n">together</span> <span class="n">now</span><span class="p">)</span> <span class="nb">all</span> <span class="n">together</span> <span class="n">now</span>
</pre></div>
</div>
<p>How would you write an end-to-end test for <code class="docutils literal notranslate"><span class="pre">uniq</span></code>?</p>
</div>
<div class="admonition-design-9-more-end-to-end-testing exercise important admonition" id="exercise-8">
<p class="admonition-title">Design-9: More end-to-end testing</p>
<ul class="simple">
<li><p>Now imagine a code which reads numbers and produces some (floating
point) numbers. How would you test that?</p></li>
<li><p>How would you test a code end-to-end which produces images?</p></li>
</ul>
</div>
<div class="admonition-design-10-create-an-actual-end-to-end-test exercise important admonition" id="exercise-9">
<p class="admonition-title">Design-10: Create an actual end-to-end test</p>
<p>Often, you can include tests that run your whole workflow or program.
For example, you might include sample data and check the output
against what you expect.  (including sample data is a great idea
anyway, so this helps a lot!)</p>
<p>We’ll use the word-count example repository
<a class="reference external" href="https://github.com/coderefinery/word-count">https://github.com/coderefinery/word-count</a>.</p>
<p>As a reminder, you can run the script like this to get some output,
which prints to standard output (the terminal):</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>python3<span class="w"> </span>code/count.py<span class="w"> </span>data/abyss.txt
</pre></div>
</div>
<p>Your goal is to make a test that can run this and let you know if it’s
successful or not.  You could use Python, or you could use shell
scripting.  You can test if these two lines are in the output: <code class="docutils literal notranslate"><span class="pre">the</span> <span class="pre">4044</span></code> and <code class="docutils literal notranslate"><span class="pre">and</span> <span class="pre">2807</span></code>.</p>
<p>Python hint:
<a class="reference external" href="https://docs.python.org/3/library/subprocess.html#subprocess.check_output">subprocess.check_output</a>
will run a command and return its output as a string.</p>
<p>Bash hint: <code class="docutils literal notranslate"><span class="pre">COMMAND</span> <span class="pre">|</span> <span class="pre">grep</span> <span class="pre">&quot;PATTERN&quot;</span></code> (“pipe to grep”) will be true if
the pattern is in the command.</p>
<div class="admonition-solution solution important dropdown admonition" id="solution-7">
<p class="admonition-title">Solution</p>
<p>There are two solutions in the repository already, in the <code class="docutils literal notranslate"><span class="pre">tests/</span></code>
dierectory <a class="reference external" href="https://github.com/coderefinery/word-count">https://github.com/coderefinery/word-count</a>, one in Python
and one in bash shell.  Neither of these are a very advanced or
perfect solution, and you could integrate them with pytest or whatever
other test framework you use.</p>
<p>The shell one works with shell and prints a bit more output:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>sh<span class="w"> </span>tests/end-to-end-shell.sh
<span class="go">the 4044</span>
<span class="go">Success: &#39;the&#39; found correct number of times</span>
<span class="go">and 2807</span>
<span class="go">Success: &#39;and&#39; found correct number of times</span>
<span class="go">Success</span>
</pre></div>
</div>
<p>The Python one:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>python3<span class="w"> </span>tests/end-to-end-python.py
<span class="go">Success</span>
</pre></div>
</div>
</div>
</div>
<div class="admonition-keypoints keypoints admonition" id="keypoints-0">
<p class="admonition-title">Keypoints</p>
<ul class="simple">
<li><p>Pure functions (these are functions without side-effects) are easiest to test.
And also easiest to reuse in another code project since they don’t depend on
any side-effects.</p></li>
<li><p>Classes can be tested but it’s somewhat more elaborate.</p></li>
</ul>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../continuous-integration/" class="btn btn-neutral float-left" title="Automated testing" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../conclusions/" class="btn btn-neutral float-right" title="Conclusions and recommendations" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright CodeRefinery contributors.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>